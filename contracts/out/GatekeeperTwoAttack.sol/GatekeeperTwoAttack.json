{"abi":[{"type":"constructor","inputs":[{"name":"GatekeeperTwoContractAddress","type":"address","internalType":"address"}],"stateMutability":"nonpayable"}],"bytecode":{"object":"0x608060405234801561000f575f80fd5b506040516101a43803806101a483398101604081905261002e9161010e565b5f80546001600160a01b0319166001600160a01b0383161781556040516001600160601b03193060601b1660208201526001600160401b039060340160408051601f198184030181529082905280516020909101205f546319b8102760e11b835260c091821c93909318901b6001600160c01b03198116600483015292506001600160a01b0390911690633370204e9061c350906024016020604051808303815f8887f11580156100e1573d5f803e3d5ffd5b50505050506040513d601f19601f82011682018060405250810190610106919061013b565b50505061015a565b5f6020828403121561011e575f80fd5b81516001600160a01b0381168114610134575f80fd5b9392505050565b5f6020828403121561014b575f80fd5b81518015158114610134575f80fd5b603e806101665f395ff3fe60806040525f80fdfea26469706673582212201df4407470d4ed73e787d652557fe6af5213ba862dad05ebd7209d0a1e03a20064736f6c63430008180033","sourceMap":"157:360:47:-:0;;;232:283;;;;;;;;;;;;;;;;;;;;;;;;;;;;:::i;:::-;292:10;:65;;-1:-1:-1;;;;;;292:65:47;-1:-1:-1;;;;;292:65:47;;;;;411:31;;-1:-1:-1;;;;;;436:4:47;483:2:155;454:15;450:45;411:31:47;;;438:58:155;-1:-1:-1;;;;;448:16:47;512:12:155;;411:31:47;;;-1:-1:-1;;411:31:47;;;;;;;;;;401:42;;411:31;401:42;;;;475:10;;-1:-1:-1;;;475:33:47;;387:58;;;;:77;;;;380:85;;-1:-1:-1;;;;;;697:37:155;;475:33:47;;;679:56:155;380:85:47;-1:-1:-1;;;;;;475:10:47;;;;:16;;497:5;;652:18:155;;475:33:47;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;:::i;:::-;;282:233;232:283;157:360;;14:290:155;84:6;137:2;125:9;116:7;112:23;108:32;105:52;;;153:1;150;143:12;105:52;179:16;;-1:-1:-1;;;;;224:31:155;;214:42;;204:70;;270:1;267;260:12;204:70;293:5;14:290;-1:-1:-1;;;14:290:155:o;746:277::-;813:6;866:2;854:9;845:7;841:23;837:32;834:52;;;882:1;879;872:12;834:52;914:9;908:16;967:5;960:13;953:21;946:5;943:32;933:60;;989:1;986;979:12;746:277;157:360:47;;;;;;","linkReferences":{}},"deployedBytecode":{"object":"0x60806040525f80fdfea26469706673582212201df4407470d4ed73e787d652557fe6af5213ba862dad05ebd7209d0a1e03a20064736f6c63430008180033","sourceMap":"157:360:47:-:0;;;;;","linkReferences":{}},"methodIdentifiers":{},"rawMetadata":"{\"compiler\":{\"version\":\"0.8.24+commit.e11b9ed9\"},\"language\":\"Solidity\",\"output\":{\"abi\":[{\"inputs\":[{\"internalType\":\"address\",\"name\":\"GatekeeperTwoContractAddress\",\"type\":\"address\"}],\"stateMutability\":\"nonpayable\",\"type\":\"constructor\"}],\"devdoc\":{\"kind\":\"dev\",\"methods\":{},\"version\":1},\"userdoc\":{\"kind\":\"user\",\"methods\":{},\"version\":1}},\"settings\":{\"compilationTarget\":{\"src/attacks/GatekeeperTwoAttack.sol\":\"GatekeeperTwoAttack\"},\"evmVersion\":\"shanghai\",\"libraries\":{},\"metadata\":{\"bytecodeHash\":\"ipfs\"},\"optimizer\":{\"enabled\":true,\"runs\":1000},\"remappings\":[\":ds-test/=lib/openzeppelin-contracts-upgradeable/lib/forge-std/lib/ds-test/src/\",\":erc4626-tests/=lib/openzeppelin-contracts-upgradeable/lib/erc4626-tests/\",\":forge-std/=lib/forge-std/src/\",\":openzeppelin-contracts-06/=lib/openzeppelin-contracts-06/contracts/\",\":openzeppelin-contracts-08/=lib/openzeppelin-contracts-08/contracts/\",\":openzeppelin-contracts-upgradeable/=lib/openzeppelin-contracts-upgradeable/\",\":openzeppelin-upgradeable/=lib/openzeppelin-contracts-upgradeable/contracts/\",\":openzeppelin/=lib/openzeppelin-contracts-upgradeable/contracts/\"]},\"sources\":{\"src/attacks/GatekeeperTwoAttack.sol\":{\"keccak256\":\"0x2dc68eec246c0569993ce227bc6f5280bfa0a130c07d2543b058cb69dfe199d4\",\"license\":\"MIT\",\"urls\":[\"bzz-raw://c5dcef793c7f8d8017b966e2052c25eaa06deb7c8c83f1f6943ef5442b4d915e\",\"dweb:/ipfs/QmehnoQbe2VZVYuJo6pmHtuo8oMmTJnV4XHpZ1sxx3Q112\"]}},\"version\":1}","metadata":{"compiler":{"version":"0.8.24+commit.e11b9ed9"},"language":"Solidity","output":{"abi":[{"inputs":[{"internalType":"address","name":"GatekeeperTwoContractAddress","type":"address"}],"stateMutability":"nonpayable","type":"constructor"}],"devdoc":{"kind":"dev","methods":{},"version":1},"userdoc":{"kind":"user","methods":{},"version":1}},"settings":{"remappings":["ds-test/=lib/openzeppelin-contracts-upgradeable/lib/forge-std/lib/ds-test/src/","erc4626-tests/=lib/openzeppelin-contracts-upgradeable/lib/erc4626-tests/","forge-std/=lib/forge-std/src/","openzeppelin-contracts-06/=lib/openzeppelin-contracts-06/contracts/","openzeppelin-contracts-08/=lib/openzeppelin-contracts-08/contracts/","openzeppelin-contracts-upgradeable/=lib/openzeppelin-contracts-upgradeable/","openzeppelin-upgradeable/=lib/openzeppelin-contracts-upgradeable/contracts/","openzeppelin/=lib/openzeppelin-contracts-upgradeable/contracts/"],"optimizer":{"enabled":true,"runs":1000},"metadata":{"bytecodeHash":"ipfs"},"compilationTarget":{"src/attacks/GatekeeperTwoAttack.sol":"GatekeeperTwoAttack"},"evmVersion":"shanghai","libraries":{}},"sources":{"src/attacks/GatekeeperTwoAttack.sol":{"keccak256":"0x2dc68eec246c0569993ce227bc6f5280bfa0a130c07d2543b058cb69dfe199d4","urls":["bzz-raw://c5dcef793c7f8d8017b966e2052c25eaa06deb7c8c83f1f6943ef5442b4d915e","dweb:/ipfs/QmehnoQbe2VZVYuJo6pmHtuo8oMmTJnV4XHpZ1sxx3Q112"],"license":"MIT"}},"version":1},"ast":{"absolutePath":"src/attacks/GatekeeperTwoAttack.sol","id":49528,"exportedSymbols":{"GatekeeperTwoAttack":[49527],"GatekeeperTwoInterface":[49476]},"nodeType":"SourceUnit","src":"33:485:47","nodes":[{"id":49468,"nodeType":"PragmaDirective","src":"33:23:47","nodes":[],"literals":["solidity","^","0.8",".0"]},{"id":49476,"nodeType":"ContractDefinition","src":"58:97:47","nodes":[{"id":49475,"nodeType":"FunctionDefinition","src":"97:56:47","nodes":[],"functionSelector":"3370204e","implemented":false,"kind":"function","modifiers":[],"name":"enter","nameLocation":"106:5:47","parameters":{"id":49471,"nodeType":"ParameterList","parameters":[{"constant":false,"id":49470,"mutability":"mutable","name":"_gateKey","nameLocation":"119:8:47","nodeType":"VariableDeclaration","scope":49475,"src":"112:15:47","stateVariable":false,"storageLocation":"default","typeDescriptions":{"typeIdentifier":"t_bytes8","typeString":"bytes8"},"typeName":{"id":49469,"name":"bytes8","nodeType":"ElementaryTypeName","src":"112:6:47","typeDescriptions":{"typeIdentifier":"t_bytes8","typeString":"bytes8"}},"visibility":"internal"}],"src":"111:17:47"},"returnParameters":{"id":49474,"nodeType":"ParameterList","parameters":[{"constant":false,"id":49473,"mutability":"mutable","name":"","nameLocation":"-1:-1:-1","nodeType":"VariableDeclaration","scope":49475,"src":"147:4:47","stateVariable":false,"storageLocation":"default","typeDescriptions":{"typeIdentifier":"t_bool","typeString":"bool"},"typeName":{"id":49472,"name":"bool","nodeType":"ElementaryTypeName","src":"147:4:47","typeDescriptions":{"typeIdentifier":"t_bool","typeString":"bool"}},"visibility":"internal"}],"src":"146:6:47"},"scope":49476,"stateMutability":"nonpayable","virtual":false,"visibility":"external"}],"abstract":false,"baseContracts":[],"canonicalName":"GatekeeperTwoInterface","contractDependencies":[],"contractKind":"interface","fullyImplemented":false,"linearizedBaseContracts":[49476],"name":"GatekeeperTwoInterface","nameLocation":"68:22:47","scope":49528,"usedErrors":[],"usedEvents":[]},{"id":49527,"nodeType":"ContractDefinition","src":"157:360:47","nodes":[{"id":49479,"nodeType":"VariableDeclaration","src":"192:33:47","nodes":[],"constant":false,"mutability":"mutable","name":"gatekeeper","nameLocation":"215:10:47","scope":49527,"stateVariable":true,"storageLocation":"default","typeDescriptions":{"typeIdentifier":"t_contract$_GatekeeperTwoInterface_$49476","typeString":"contract GatekeeperTwoInterface"},"typeName":{"id":49478,"nodeType":"UserDefinedTypeName","pathNode":{"id":49477,"name":"GatekeeperTwoInterface","nameLocations":["192:22:47"],"nodeType":"IdentifierPath","referencedDeclaration":49476,"src":"192:22:47"},"referencedDeclaration":49476,"src":"192:22:47","typeDescriptions":{"typeIdentifier":"t_contract$_GatekeeperTwoInterface_$49476","typeString":"contract GatekeeperTwoInterface"}},"visibility":"internal"},{"id":49526,"nodeType":"FunctionDefinition","src":"232:283:47","nodes":[],"body":{"id":49525,"nodeType":"Block","src":"282:233:47","nodes":[],"statements":[{"expression":{"id":49488,"isConstant":false,"isLValue":false,"isPure":false,"lValueRequested":false,"leftHandSide":{"id":49484,"name":"gatekeeper","nodeType":"Identifier","overloadedDeclarations":[],"referencedDeclaration":49479,"src":"292:10:47","typeDescriptions":{"typeIdentifier":"t_contract$_GatekeeperTwoInterface_$49476","typeString":"contract GatekeeperTwoInterface"}},"nodeType":"Assignment","operator":"=","rightHandSide":{"arguments":[{"id":49486,"name":"GatekeeperTwoContractAddress","nodeType":"Identifier","overloadedDeclarations":[],"referencedDeclaration":49481,"src":"328:28:47","typeDescriptions":{"typeIdentifier":"t_address","typeString":"address"}}],"expression":{"argumentTypes":[{"typeIdentifier":"t_address","typeString":"address"}],"id":49485,"name":"GatekeeperTwoInterface","nodeType":"Identifier","overloadedDeclarations":[],"referencedDeclaration":49476,"src":"305:22:47","typeDescriptions":{"typeIdentifier":"t_type$_t_contract$_GatekeeperTwoInterface_$49476_$","typeString":"type(contract GatekeeperTwoInterface)"}},"id":49487,"isConstant":false,"isLValue":false,"isPure":false,"kind":"typeConversion","lValueRequested":false,"nameLocations":[],"names":[],"nodeType":"FunctionCall","src":"305:52:47","tryCall":false,"typeDescriptions":{"typeIdentifier":"t_contract$_GatekeeperTwoInterface_$49476","typeString":"contract GatekeeperTwoInterface"}},"src":"292:65:47","typeDescriptions":{"typeIdentifier":"t_contract$_GatekeeperTwoInterface_$49476","typeString":"contract GatekeeperTwoInterface"}},"id":49489,"nodeType":"ExpressionStatement","src":"292:65:47"},{"assignments":[49491],"declarations":[{"constant":false,"id":49491,"mutability":"mutable","name":"key","nameLocation":"374:3:47","nodeType":"VariableDeclaration","scope":49525,"src":"367:10:47","stateVariable":false,"storageLocation":"default","typeDescriptions":{"typeIdentifier":"t_bytes8","typeString":"bytes8"},"typeName":{"id":49490,"name":"bytes8","nodeType":"ElementaryTypeName","src":"367:6:47","typeDescriptions":{"typeIdentifier":"t_bytes8","typeString":"bytes8"}},"visibility":"internal"}],"id":49516,"initialValue":{"arguments":[{"commonType":{"typeIdentifier":"t_uint64","typeString":"uint64"},"id":49514,"isConstant":false,"isLValue":false,"isPure":false,"lValueRequested":false,"leftExpression":{"arguments":[{"arguments":[{"arguments":[{"arguments":[{"arguments":[{"id":49503,"name":"this","nodeType":"Identifier","overloadedDeclarations":[],"referencedDeclaration":-28,"src":"436:4:47","typeDescriptions":{"typeIdentifier":"t_contract$_GatekeeperTwoAttack_$49527","typeString":"contract GatekeeperTwoAttack"}}],"expression":{"argumentTypes":[{"typeIdentifier":"t_contract$_GatekeeperTwoAttack_$49527","typeString":"contract GatekeeperTwoAttack"}],"id":49502,"isConstant":false,"isLValue":false,"isPure":true,"lValueRequested":false,"nodeType":"ElementaryTypeNameExpression","src":"428:7:47","typeDescriptions":{"typeIdentifier":"t_type$_t_address_$","typeString":"type(address)"},"typeName":{"id":49501,"name":"address","nodeType":"ElementaryTypeName","src":"428:7:47","typeDescriptions":{}}},"id":49504,"isConstant":false,"isLValue":false,"isPure":false,"kind":"typeConversion","lValueRequested":false,"nameLocations":[],"names":[],"nodeType":"FunctionCall","src":"428:13:47","tryCall":false,"typeDescriptions":{"typeIdentifier":"t_address","typeString":"address"}}],"expression":{"argumentTypes":[{"typeIdentifier":"t_address","typeString":"address"}],"expression":{"id":49499,"name":"abi","nodeType":"Identifier","overloadedDeclarations":[],"referencedDeclaration":-1,"src":"411:3:47","typeDescriptions":{"typeIdentifier":"t_magic_abi","typeString":"abi"}},"id":49500,"isConstant":false,"isLValue":false,"isPure":true,"lValueRequested":false,"memberLocation":"415:12:47","memberName":"encodePacked","nodeType":"MemberAccess","src":"411:16:47","typeDescriptions":{"typeIdentifier":"t_function_abiencodepacked_pure$__$returns$_t_bytes_memory_ptr_$","typeString":"function () pure returns (bytes memory)"}},"id":49505,"isConstant":false,"isLValue":false,"isPure":false,"kind":"functionCall","lValueRequested":false,"nameLocations":[],"names":[],"nodeType":"FunctionCall","src":"411:31:47","tryCall":false,"typeDescriptions":{"typeIdentifier":"t_bytes_memory_ptr","typeString":"bytes memory"}}],"expression":{"argumentTypes":[{"typeIdentifier":"t_bytes_memory_ptr","typeString":"bytes memory"}],"id":49498,"name":"keccak256","nodeType":"Identifier","overloadedDeclarations":[],"referencedDeclaration":-8,"src":"401:9:47","typeDescriptions":{"typeIdentifier":"t_function_keccak256_pure$_t_bytes_memory_ptr_$returns$_t_bytes32_$","typeString":"function (bytes memory) pure returns (bytes32)"}},"id":49506,"isConstant":false,"isLValue":false,"isPure":false,"kind":"functionCall","lValueRequested":false,"nameLocations":[],"names":[],"nodeType":"FunctionCall","src":"401:42:47","tryCall":false,"typeDescriptions":{"typeIdentifier":"t_bytes32","typeString":"bytes32"}}],"expression":{"argumentTypes":[{"typeIdentifier":"t_bytes32","typeString":"bytes32"}],"id":49497,"isConstant":false,"isLValue":false,"isPure":true,"lValueRequested":false,"nodeType":"ElementaryTypeNameExpression","src":"394:6:47","typeDescriptions":{"typeIdentifier":"t_type$_t_bytes8_$","typeString":"type(bytes8)"},"typeName":{"id":49496,"name":"bytes8","nodeType":"ElementaryTypeName","src":"394:6:47","typeDescriptions":{}}},"id":49507,"isConstant":false,"isLValue":false,"isPure":false,"kind":"typeConversion","lValueRequested":false,"nameLocations":[],"names":[],"nodeType":"FunctionCall","src":"394:50:47","tryCall":false,"typeDescriptions":{"typeIdentifier":"t_bytes8","typeString":"bytes8"}}],"expression":{"argumentTypes":[{"typeIdentifier":"t_bytes8","typeString":"bytes8"}],"id":49495,"isConstant":false,"isLValue":false,"isPure":true,"lValueRequested":false,"nodeType":"ElementaryTypeNameExpression","src":"387:6:47","typeDescriptions":{"typeIdentifier":"t_type$_t_uint64_$","typeString":"type(uint64)"},"typeName":{"id":49494,"name":"uint64","nodeType":"ElementaryTypeName","src":"387:6:47","typeDescriptions":{}}},"id":49508,"isConstant":false,"isLValue":false,"isPure":false,"kind":"typeConversion","lValueRequested":false,"nameLocations":[],"names":[],"nodeType":"FunctionCall","src":"387:58:47","tryCall":false,"typeDescriptions":{"typeIdentifier":"t_uint64","typeString":"uint64"}},"nodeType":"BinaryOperation","operator":"^","rightExpression":{"expression":{"arguments":[{"id":49511,"isConstant":false,"isLValue":false,"isPure":true,"lValueRequested":false,"nodeType":"ElementaryTypeNameExpression","src":"453:6:47","typeDescriptions":{"typeIdentifier":"t_type$_t_uint64_$","typeString":"type(uint64)"},"typeName":{"id":49510,"name":"uint64","nodeType":"ElementaryTypeName","src":"453:6:47","typeDescriptions":{}}}],"expression":{"argumentTypes":[{"typeIdentifier":"t_type$_t_uint64_$","typeString":"type(uint64)"}],"id":49509,"name":"type","nodeType":"Identifier","overloadedDeclarations":[],"referencedDeclaration":-27,"src":"448:4:47","typeDescriptions":{"typeIdentifier":"t_function_metatype_pure$__$returns$__$","typeString":"function () pure"}},"id":49512,"isConstant":false,"isLValue":false,"isPure":true,"kind":"functionCall","lValueRequested":false,"nameLocations":[],"names":[],"nodeType":"FunctionCall","src":"448:12:47","tryCall":false,"typeDescriptions":{"typeIdentifier":"t_magic_meta_type_t_uint64","typeString":"type(uint64)"}},"id":49513,"isConstant":false,"isLValue":false,"isPure":true,"lValueRequested":false,"memberLocation":"461:3:47","memberName":"max","nodeType":"MemberAccess","src":"448:16:47","typeDescriptions":{"typeIdentifier":"t_uint64","typeString":"uint64"}},"src":"387:77:47","typeDescriptions":{"typeIdentifier":"t_uint64","typeString":"uint64"}}],"expression":{"argumentTypes":[{"typeIdentifier":"t_uint64","typeString":"uint64"}],"id":49493,"isConstant":false,"isLValue":false,"isPure":true,"lValueRequested":false,"nodeType":"ElementaryTypeNameExpression","src":"380:6:47","typeDescriptions":{"typeIdentifier":"t_type$_t_bytes8_$","typeString":"type(bytes8)"},"typeName":{"id":49492,"name":"bytes8","nodeType":"ElementaryTypeName","src":"380:6:47","typeDescriptions":{}}},"id":49515,"isConstant":false,"isLValue":false,"isPure":false,"kind":"typeConversion","lValueRequested":false,"nameLocations":[],"names":[],"nodeType":"FunctionCall","src":"380:85:47","tryCall":false,"typeDescriptions":{"typeIdentifier":"t_bytes8","typeString":"bytes8"}},"nodeType":"VariableDeclarationStatement","src":"367:98:47"},{"expression":{"arguments":[{"id":49522,"name":"key","nodeType":"Identifier","overloadedDeclarations":[],"referencedDeclaration":49491,"src":"504:3:47","typeDescriptions":{"typeIdentifier":"t_bytes8","typeString":"bytes8"}}],"expression":{"argumentTypes":[{"typeIdentifier":"t_bytes8","typeString":"bytes8"}],"expression":{"argumentTypes":[{"typeIdentifier":"t_bytes8","typeString":"bytes8"}],"expression":{"id":49517,"name":"gatekeeper","nodeType":"Identifier","overloadedDeclarations":[],"referencedDeclaration":49479,"src":"475:10:47","typeDescriptions":{"typeIdentifier":"t_contract$_GatekeeperTwoInterface_$49476","typeString":"contract GatekeeperTwoInterface"}},"id":49519,"isConstant":false,"isLValue":false,"isPure":false,"lValueRequested":false,"memberLocation":"486:5:47","memberName":"enter","nodeType":"MemberAccess","referencedDeclaration":49475,"src":"475:16:47","typeDescriptions":{"typeIdentifier":"t_function_external_nonpayable$_t_bytes8_$returns$_t_bool_$","typeString":"function (bytes8) external returns (bool)"}},"id":49521,"isConstant":false,"isLValue":false,"isPure":false,"lValueRequested":false,"names":["gas"],"nodeType":"FunctionCallOptions","options":[{"hexValue":"3530303030","id":49520,"isConstant":false,"isLValue":false,"isPure":true,"kind":"number","lValueRequested":false,"nodeType":"Literal","src":"497:5:47","typeDescriptions":{"typeIdentifier":"t_rational_50000_by_1","typeString":"int_const 50000"},"value":"50000"}],"src":"475:28:47","typeDescriptions":{"typeIdentifier":"t_function_external_nonpayable$_t_bytes8_$returns$_t_bool_$gas","typeString":"function (bytes8) external returns (bool)"}},"id":49523,"isConstant":false,"isLValue":false,"isPure":false,"kind":"functionCall","lValueRequested":false,"nameLocations":[],"names":[],"nodeType":"FunctionCall","src":"475:33:47","tryCall":false,"typeDescriptions":{"typeIdentifier":"t_bool","typeString":"bool"}},"id":49524,"nodeType":"ExpressionStatement","src":"475:33:47"}]},"implemented":true,"kind":"constructor","modifiers":[],"name":"","nameLocation":"-1:-1:-1","parameters":{"id":49482,"nodeType":"ParameterList","parameters":[{"constant":false,"id":49481,"mutability":"mutable","name":"GatekeeperTwoContractAddress","nameLocation":"252:28:47","nodeType":"VariableDeclaration","scope":49526,"src":"244:36:47","stateVariable":false,"storageLocation":"default","typeDescriptions":{"typeIdentifier":"t_address","typeString":"address"},"typeName":{"id":49480,"name":"address","nodeType":"ElementaryTypeName","src":"244:7:47","stateMutability":"nonpayable","typeDescriptions":{"typeIdentifier":"t_address","typeString":"address"}},"visibility":"internal"}],"src":"243:38:47"},"returnParameters":{"id":49483,"nodeType":"ParameterList","parameters":[],"src":"282:0:47"},"scope":49527,"stateMutability":"nonpayable","virtual":false,"visibility":"public"}],"abstract":false,"baseContracts":[],"canonicalName":"GatekeeperTwoAttack","contractDependencies":[],"contractKind":"contract","fullyImplemented":true,"linearizedBaseContracts":[49527],"name":"GatekeeperTwoAttack","nameLocation":"166:19:47","scope":49528,"usedErrors":[],"usedEvents":[]}],"license":"MIT"},"id":47}