{"abi":[{"type":"function","name":"notify","inputs":[{"name":"user","type":"address","internalType":"address"},{"name":"msgData","type":"bytes","internalType":"bytes"}],"outputs":[],"stateMutability":"nonpayable"},{"type":"function","name":"raiseAlert","inputs":[{"name":"user","type":"address","internalType":"address"}],"outputs":[],"stateMutability":"nonpayable"},{"type":"function","name":"setDetectionBot","inputs":[{"name":"detectionBotAddress","type":"address","internalType":"address"}],"outputs":[],"stateMutability":"nonpayable"}],"bytecode":{"object":"0x","sourceMap":"","linkReferences":{}},"deployedBytecode":{"object":"0x","sourceMap":"","linkReferences":{}},"methodIdentifiers":{"notify(address,bytes)":"fa1fd28c","raiseAlert(address)":"087a43c1","setDetectionBot(address)":"9e927c68"},"rawMetadata":"{\"compiler\":{\"version\":\"0.8.24+commit.e11b9ed9\"},\"language\":\"Solidity\",\"output\":{\"abi\":[{\"inputs\":[{\"internalType\":\"address\",\"name\":\"user\",\"type\":\"address\"},{\"internalType\":\"bytes\",\"name\":\"msgData\",\"type\":\"bytes\"}],\"name\":\"notify\",\"outputs\":[],\"stateMutability\":\"nonpayable\",\"type\":\"function\"},{\"inputs\":[{\"internalType\":\"address\",\"name\":\"user\",\"type\":\"address\"}],\"name\":\"raiseAlert\",\"outputs\":[],\"stateMutability\":\"nonpayable\",\"type\":\"function\"},{\"inputs\":[{\"internalType\":\"address\",\"name\":\"detectionBotAddress\",\"type\":\"address\"}],\"name\":\"setDetectionBot\",\"outputs\":[],\"stateMutability\":\"nonpayable\",\"type\":\"function\"}],\"devdoc\":{\"kind\":\"dev\",\"methods\":{},\"version\":1},\"userdoc\":{\"kind\":\"user\",\"methods\":{},\"version\":1}},\"settings\":{\"compilationTarget\":{\"src/attacks/DetectionBot.sol\":\"IForta\"},\"evmVersion\":\"shanghai\",\"libraries\":{},\"metadata\":{\"bytecodeHash\":\"ipfs\"},\"optimizer\":{\"enabled\":true,\"runs\":1000},\"remappings\":[\":ds-test/=lib/openzeppelin-contracts-upgradeable/lib/forge-std/lib/ds-test/src/\",\":erc4626-tests/=lib/openzeppelin-contracts-upgradeable/lib/erc4626-tests/\",\":forge-std/=lib/forge-std/src/\",\":openzeppelin-contracts-06/=lib/openzeppelin-contracts-06/contracts/\",\":openzeppelin-contracts-08/=lib/openzeppelin-contracts-08/contracts/\",\":openzeppelin-contracts-upgradeable/=lib/openzeppelin-contracts-upgradeable/\",\":openzeppelin-upgradeable/=lib/openzeppelin-contracts-upgradeable/contracts/\",\":openzeppelin/=lib/openzeppelin-contracts-upgradeable/contracts/\"]},\"sources\":{\"src/attacks/DetectionBot.sol\":{\"keccak256\":\"0x29b96534de1831d28a5f7ee010ab542cac0a70b901550202c0191739ae2dcb75\",\"license\":\"MIT\",\"urls\":[\"bzz-raw://38b60ee52ef3db90f0c53a404a57af243f9de3db58a6539000d3453bcf678665\",\"dweb:/ipfs/QmbFn3HdcfKAPCcUfbzEwB7REu4Lh1CqyW82BD9a5Pg1yN\"]}},\"version\":1}","metadata":{"compiler":{"version":"0.8.24+commit.e11b9ed9"},"language":"Solidity","output":{"abi":[{"inputs":[{"internalType":"address","name":"user","type":"address"},{"internalType":"bytes","name":"msgData","type":"bytes"}],"stateMutability":"nonpayable","type":"function","name":"notify"},{"inputs":[{"internalType":"address","name":"user","type":"address"}],"stateMutability":"nonpayable","type":"function","name":"raiseAlert"},{"inputs":[{"internalType":"address","name":"detectionBotAddress","type":"address"}],"stateMutability":"nonpayable","type":"function","name":"setDetectionBot"}],"devdoc":{"kind":"dev","methods":{},"version":1},"userdoc":{"kind":"user","methods":{},"version":1}},"settings":{"remappings":["ds-test/=lib/openzeppelin-contracts-upgradeable/lib/forge-std/lib/ds-test/src/","erc4626-tests/=lib/openzeppelin-contracts-upgradeable/lib/erc4626-tests/","forge-std/=lib/forge-std/src/","openzeppelin-contracts-06/=lib/openzeppelin-contracts-06/contracts/","openzeppelin-contracts-08/=lib/openzeppelin-contracts-08/contracts/","openzeppelin-contracts-upgradeable/=lib/openzeppelin-contracts-upgradeable/","openzeppelin-upgradeable/=lib/openzeppelin-contracts-upgradeable/contracts/","openzeppelin/=lib/openzeppelin-contracts-upgradeable/contracts/"],"optimizer":{"enabled":true,"runs":1000},"metadata":{"bytecodeHash":"ipfs"},"compilationTarget":{"src/attacks/DetectionBot.sol":"IForta"},"evmVersion":"shanghai","libraries":{}},"sources":{"src/attacks/DetectionBot.sol":{"keccak256":"0x29b96534de1831d28a5f7ee010ab542cac0a70b901550202c0191739ae2dcb75","urls":["bzz-raw://38b60ee52ef3db90f0c53a404a57af243f9de3db58a6539000d3453bcf678665","dweb:/ipfs/QmbFn3HdcfKAPCcUfbzEwB7REu4Lh1CqyW82BD9a5Pg1yN"],"license":"MIT"}},"version":1},"ast":{"absolutePath":"src/attacks/DetectionBot.sol","id":49249,"exportedSymbols":{"DetectionBot":[49248],"IDetectionBot":[49184],"IForta":[49202]},"nodeType":"SourceUnit","src":"32:772:41","nodes":[{"id":49176,"nodeType":"PragmaDirective","src":"32:23:41","nodes":[],"literals":["solidity","^","0.8",".0"]},{"id":49184,"nodeType":"ContractDefinition","src":"57:106:41","nodes":[{"id":49183,"nodeType":"FunctionDefinition","src":"87:74:41","nodes":[],"functionSelector":"220ab6aa","implemented":false,"kind":"function","modifiers":[],"name":"handleTransaction","nameLocation":"96:17:41","parameters":{"id":49181,"nodeType":"ParameterList","parameters":[{"constant":false,"id":49178,"mutability":"mutable","name":"user","nameLocation":"122:4:41","nodeType":"VariableDeclaration","scope":49183,"src":"114:12:41","stateVariable":false,"storageLocation":"default","typeDescriptions":{"typeIdentifier":"t_address","typeString":"address"},"typeName":{"id":49177,"name":"address","nodeType":"ElementaryTypeName","src":"114:7:41","stateMutability":"nonpayable","typeDescriptions":{"typeIdentifier":"t_address","typeString":"address"}},"visibility":"internal"},{"constant":false,"id":49180,"mutability":"mutable","name":"msgData","nameLocation":"143:7:41","nodeType":"VariableDeclaration","scope":49183,"src":"128:22:41","stateVariable":false,"storageLocation":"calldata","typeDescriptions":{"typeIdentifier":"t_bytes_calldata_ptr","typeString":"bytes"},"typeName":{"id":49179,"name":"bytes","nodeType":"ElementaryTypeName","src":"128:5:41","typeDescriptions":{"typeIdentifier":"t_bytes_storage_ptr","typeString":"bytes"}},"visibility":"internal"}],"src":"113:38:41"},"returnParameters":{"id":49182,"nodeType":"ParameterList","parameters":[],"src":"160:0:41"},"scope":49184,"stateMutability":"nonpayable","virtual":false,"visibility":"external"}],"abstract":false,"baseContracts":[],"canonicalName":"IDetectionBot","contractDependencies":[],"contractKind":"interface","fullyImplemented":false,"linearizedBaseContracts":[49184],"name":"IDetectionBot","nameLocation":"67:13:41","scope":49249,"usedErrors":[],"usedEvents":[]},{"id":49202,"nodeType":"ContractDefinition","src":"165:204:41","nodes":[{"id":49189,"nodeType":"FunctionDefinition","src":"188:63:41","nodes":[],"functionSelector":"9e927c68","implemented":false,"kind":"function","modifiers":[],"name":"setDetectionBot","nameLocation":"197:15:41","parameters":{"id":49187,"nodeType":"ParameterList","parameters":[{"constant":false,"id":49186,"mutability":"mutable","name":"detectionBotAddress","nameLocation":"221:19:41","nodeType":"VariableDeclaration","scope":49189,"src":"213:27:41","stateVariable":false,"storageLocation":"default","typeDescriptions":{"typeIdentifier":"t_address","typeString":"address"},"typeName":{"id":49185,"name":"address","nodeType":"ElementaryTypeName","src":"213:7:41","stateMutability":"nonpayable","typeDescriptions":{"typeIdentifier":"t_address","typeString":"address"}},"visibility":"internal"}],"src":"212:29:41"},"returnParameters":{"id":49188,"nodeType":"ParameterList","parameters":[],"src":"250:0:41"},"scope":49202,"stateMutability":"nonpayable","virtual":false,"visibility":"external"},{"id":49196,"nodeType":"FunctionDefinition","src":"256:63:41","nodes":[],"functionSelector":"fa1fd28c","implemented":false,"kind":"function","modifiers":[],"name":"notify","nameLocation":"265:6:41","parameters":{"id":49194,"nodeType":"ParameterList","parameters":[{"constant":false,"id":49191,"mutability":"mutable","name":"user","nameLocation":"280:4:41","nodeType":"VariableDeclaration","scope":49196,"src":"272:12:41","stateVariable":false,"storageLocation":"default","typeDescriptions":{"typeIdentifier":"t_address","typeString":"address"},"typeName":{"id":49190,"name":"address","nodeType":"ElementaryTypeName","src":"272:7:41","stateMutability":"nonpayable","typeDescriptions":{"typeIdentifier":"t_address","typeString":"address"}},"visibility":"internal"},{"constant":false,"id":49193,"mutability":"mutable","name":"msgData","nameLocation":"301:7:41","nodeType":"VariableDeclaration","scope":49196,"src":"286:22:41","stateVariable":false,"storageLocation":"calldata","typeDescriptions":{"typeIdentifier":"t_bytes_calldata_ptr","typeString":"bytes"},"typeName":{"id":49192,"name":"bytes","nodeType":"ElementaryTypeName","src":"286:5:41","typeDescriptions":{"typeIdentifier":"t_bytes_storage_ptr","typeString":"bytes"}},"visibility":"internal"}],"src":"271:38:41"},"returnParameters":{"id":49195,"nodeType":"ParameterList","parameters":[],"src":"318:0:41"},"scope":49202,"stateMutability":"nonpayable","virtual":false,"visibility":"external"},{"id":49201,"nodeType":"FunctionDefinition","src":"324:43:41","nodes":[],"functionSelector":"087a43c1","implemented":false,"kind":"function","modifiers":[],"name":"raiseAlert","nameLocation":"333:10:41","parameters":{"id":49199,"nodeType":"ParameterList","parameters":[{"constant":false,"id":49198,"mutability":"mutable","name":"user","nameLocation":"352:4:41","nodeType":"VariableDeclaration","scope":49201,"src":"344:12:41","stateVariable":false,"storageLocation":"default","typeDescriptions":{"typeIdentifier":"t_address","typeString":"address"},"typeName":{"id":49197,"name":"address","nodeType":"ElementaryTypeName","src":"344:7:41","stateMutability":"nonpayable","typeDescriptions":{"typeIdentifier":"t_address","typeString":"address"}},"visibility":"internal"}],"src":"343:14:41"},"returnParameters":{"id":49200,"nodeType":"ParameterList","parameters":[],"src":"366:0:41"},"scope":49202,"stateMutability":"nonpayable","virtual":false,"visibility":"external"}],"abstract":false,"baseContracts":[],"canonicalName":"IForta","contractDependencies":[],"contractKind":"interface","fullyImplemented":false,"linearizedBaseContracts":[49202],"name":"IForta","nameLocation":"175:6:41","scope":49249,"usedErrors":[],"usedEvents":[]},{"id":49248,"nodeType":"ContractDefinition","src":"371:432:41","nodes":[{"id":49207,"nodeType":"VariableDeclaration","src":"416:27:41","nodes":[],"constant":false,"functionSelector":"f11476bc","mutability":"mutable","name":"fortaContract","nameLocation":"430:13:41","scope":49248,"stateVariable":true,"storageLocation":"default","typeDescriptions":{"typeIdentifier":"t_contract$_IForta_$49202","typeString":"contract IForta"},"typeName":{"id":49206,"nodeType":"UserDefinedTypeName","pathNode":{"id":49205,"name":"IForta","nameLocations":["416:6:41"],"nodeType":"IdentifierPath","referencedDeclaration":49202,"src":"416:6:41"},"referencedDeclaration":49202,"src":"416:6:41","typeDescriptions":{"typeIdentifier":"t_contract$_IForta_$49202","typeString":"contract IForta"}},"visibility":"public"},{"id":49219,"nodeType":"FunctionDefinition","src":"450:73:41","nodes":[],"body":{"id":49218,"nodeType":"Block","src":"477:46:41","nodes":[],"statements":[{"expression":{"id":49216,"isConstant":false,"isLValue":false,"isPure":false,"lValueRequested":false,"leftHandSide":{"id":49212,"name":"fortaContract","nodeType":"Identifier","overloadedDeclarations":[],"referencedDeclaration":49207,"src":"487:13:41","typeDescriptions":{"typeIdentifier":"t_contract$_IForta_$49202","typeString":"contract IForta"}},"nodeType":"Assignment","operator":"=","rightHandSide":{"arguments":[{"id":49214,"name":"forta","nodeType":"Identifier","overloadedDeclarations":[],"referencedDeclaration":49209,"src":"510:5:41","typeDescriptions":{"typeIdentifier":"t_address","typeString":"address"}}],"expression":{"argumentTypes":[{"typeIdentifier":"t_address","typeString":"address"}],"id":49213,"name":"IForta","nodeType":"Identifier","overloadedDeclarations":[],"referencedDeclaration":49202,"src":"503:6:41","typeDescriptions":{"typeIdentifier":"t_type$_t_contract$_IForta_$49202_$","typeString":"type(contract IForta)"}},"id":49215,"isConstant":false,"isLValue":false,"isPure":false,"kind":"typeConversion","lValueRequested":false,"nameLocations":[],"names":[],"nodeType":"FunctionCall","src":"503:13:41","tryCall":false,"typeDescriptions":{"typeIdentifier":"t_contract$_IForta_$49202","typeString":"contract IForta"}},"src":"487:29:41","typeDescriptions":{"typeIdentifier":"t_contract$_IForta_$49202","typeString":"contract IForta"}},"id":49217,"nodeType":"ExpressionStatement","src":"487:29:41"}]},"implemented":true,"kind":"constructor","modifiers":[],"name":"","nameLocation":"-1:-1:-1","parameters":{"id":49210,"nodeType":"ParameterList","parameters":[{"constant":false,"id":49209,"mutability":"mutable","name":"forta","nameLocation":"470:5:41","nodeType":"VariableDeclaration","scope":49219,"src":"462:13:41","stateVariable":false,"storageLocation":"default","typeDescriptions":{"typeIdentifier":"t_address","typeString":"address"},"typeName":{"id":49208,"name":"address","nodeType":"ElementaryTypeName","src":"462:7:41","stateMutability":"nonpayable","typeDescriptions":{"typeIdentifier":"t_address","typeString":"address"}},"visibility":"internal"}],"src":"461:15:41"},"returnParameters":{"id":49211,"nodeType":"ParameterList","parameters":[],"src":"477:0:41"},"scope":49248,"stateMutability":"nonpayable","virtual":false,"visibility":"public"},{"id":49247,"nodeType":"FunctionDefinition","src":"529:272:41","nodes":[],"body":{"id":49246,"nodeType":"Block","src":"610:191:41","nodes":[],"statements":[{"expression":{"arguments":[{"commonType":{"typeIdentifier":"t_address","typeString":"address"},"id":49234,"isConstant":false,"isLValue":false,"isPure":false,"lValueRequested":false,"leftExpression":{"expression":{"id":49228,"name":"msg","nodeType":"Identifier","overloadedDeclarations":[],"referencedDeclaration":-15,"src":"684:3:41","typeDescriptions":{"typeIdentifier":"t_magic_message","typeString":"msg"}},"id":49229,"isConstant":false,"isLValue":false,"isPure":false,"lValueRequested":false,"memberLocation":"688:6:41","memberName":"sender","nodeType":"MemberAccess","src":"684:10:41","typeDescriptions":{"typeIdentifier":"t_address","typeString":"address"}},"nodeType":"BinaryOperation","operator":"==","rightExpression":{"arguments":[{"id":49232,"name":"fortaContract","nodeType":"Identifier","overloadedDeclarations":[],"referencedDeclaration":49207,"src":"706:13:41","typeDescriptions":{"typeIdentifier":"t_contract$_IForta_$49202","typeString":"contract IForta"}}],"expression":{"argumentTypes":[{"typeIdentifier":"t_contract$_IForta_$49202","typeString":"contract IForta"}],"id":49231,"isConstant":false,"isLValue":false,"isPure":true,"lValueRequested":false,"nodeType":"ElementaryTypeNameExpression","src":"698:7:41","typeDescriptions":{"typeIdentifier":"t_type$_t_address_$","typeString":"type(address)"},"typeName":{"id":49230,"name":"address","nodeType":"ElementaryTypeName","src":"698:7:41","typeDescriptions":{}}},"id":49233,"isConstant":false,"isLValue":false,"isPure":false,"kind":"typeConversion","lValueRequested":false,"nameLocations":[],"names":[],"nodeType":"FunctionCall","src":"698:22:41","tryCall":false,"typeDescriptions":{"typeIdentifier":"t_address","typeString":"address"}},"src":"684:36:41","typeDescriptions":{"typeIdentifier":"t_bool","typeString":"bool"}},{"hexValue":"556e617574686f72697a6564","id":49235,"isConstant":false,"isLValue":false,"isPure":true,"kind":"string","lValueRequested":false,"nodeType":"Literal","src":"722:14:41","typeDescriptions":{"typeIdentifier":"t_stringliteral_1b2638459828301e8cd6c7c02856073bacf975379e0867f689bb14feacb780c5","typeString":"literal_string \"Unauthorized\""},"value":"Unauthorized"}],"expression":{"argumentTypes":[{"typeIdentifier":"t_bool","typeString":"bool"},{"typeIdentifier":"t_stringliteral_1b2638459828301e8cd6c7c02856073bacf975379e0867f689bb14feacb780c5","typeString":"literal_string \"Unauthorized\""}],"id":49227,"name":"require","nodeType":"Identifier","overloadedDeclarations":[-18,-18],"referencedDeclaration":-18,"src":"676:7:41","typeDescriptions":{"typeIdentifier":"t_function_require_pure$_t_bool_$_t_string_memory_ptr_$returns$__$","typeString":"function (bool,string memory) pure"}},"id":49236,"isConstant":false,"isLValue":false,"isPure":false,"kind":"functionCall","lValueRequested":false,"nameLocations":[],"names":[],"nodeType":"FunctionCall","src":"676:61:41","tryCall":false,"typeDescriptions":{"typeIdentifier":"t_tuple$__$","typeString":"tuple()"}},"id":49237,"nodeType":"ExpressionStatement","src":"676:61:41"},{"expression":{"arguments":[{"id":49241,"name":"user","nodeType":"Identifier","overloadedDeclarations":[],"referencedDeclaration":49221,"src":"772:4:41","typeDescriptions":{"typeIdentifier":"t_address","typeString":"address"}}],"expression":{"argumentTypes":[{"typeIdentifier":"t_address","typeString":"address"}],"expression":{"id":49238,"name":"fortaContract","nodeType":"Identifier","overloadedDeclarations":[],"referencedDeclaration":49207,"src":"747:13:41","typeDescriptions":{"typeIdentifier":"t_contract$_IForta_$49202","typeString":"contract IForta"}},"id":49240,"isConstant":false,"isLValue":false,"isPure":false,"lValueRequested":false,"memberLocation":"761:10:41","memberName":"raiseAlert","nodeType":"MemberAccess","referencedDeclaration":49201,"src":"747:24:41","typeDescriptions":{"typeIdentifier":"t_function_external_nonpayable$_t_address_$returns$__$","typeString":"function (address) external"}},"id":49242,"isConstant":false,"isLValue":false,"isPure":false,"kind":"functionCall","lValueRequested":false,"nameLocations":[],"names":[],"nodeType":"FunctionCall","src":"747:30:41","tryCall":false,"typeDescriptions":{"typeIdentifier":"t_tuple$__$","typeString":"tuple()"}},"id":49243,"nodeType":"ExpressionStatement","src":"747:30:41"},{"expression":{"id":49244,"name":"msgData","nodeType":"Identifier","overloadedDeclarations":[],"referencedDeclaration":49223,"src":"787:7:41","typeDescriptions":{"typeIdentifier":"t_bytes_calldata_ptr","typeString":"bytes calldata"}},"id":49245,"nodeType":"ExpressionStatement","src":"787:7:41"}]},"baseFunctions":[49183],"functionSelector":"220ab6aa","implemented":true,"kind":"function","modifiers":[],"name":"handleTransaction","nameLocation":"538:17:41","overrides":{"id":49225,"nodeType":"OverrideSpecifier","overrides":[],"src":"601:8:41"},"parameters":{"id":49224,"nodeType":"ParameterList","parameters":[{"constant":false,"id":49221,"mutability":"mutable","name":"user","nameLocation":"564:4:41","nodeType":"VariableDeclaration","scope":49247,"src":"556:12:41","stateVariable":false,"storageLocation":"default","typeDescriptions":{"typeIdentifier":"t_address","typeString":"address"},"typeName":{"id":49220,"name":"address","nodeType":"ElementaryTypeName","src":"556:7:41","stateMutability":"nonpayable","typeDescriptions":{"typeIdentifier":"t_address","typeString":"address"}},"visibility":"internal"},{"constant":false,"id":49223,"mutability":"mutable","name":"msgData","nameLocation":"585:7:41","nodeType":"VariableDeclaration","scope":49247,"src":"570:22:41","stateVariable":false,"storageLocation":"calldata","typeDescriptions":{"typeIdentifier":"t_bytes_calldata_ptr","typeString":"bytes"},"typeName":{"id":49222,"name":"bytes","nodeType":"ElementaryTypeName","src":"570:5:41","typeDescriptions":{"typeIdentifier":"t_bytes_storage_ptr","typeString":"bytes"}},"visibility":"internal"}],"src":"555:38:41"},"returnParameters":{"id":49226,"nodeType":"ParameterList","parameters":[],"src":"610:0:41"},"scope":49248,"stateMutability":"nonpayable","virtual":false,"visibility":"public"}],"abstract":false,"baseContracts":[{"baseName":{"id":49203,"name":"IDetectionBot","nameLocations":["396:13:41"],"nodeType":"IdentifierPath","referencedDeclaration":49184,"src":"396:13:41"},"id":49204,"nodeType":"InheritanceSpecifier","src":"396:13:41"}],"canonicalName":"DetectionBot","contractDependencies":[],"contractKind":"contract","fullyImplemented":true,"linearizedBaseContracts":[49248,49184],"name":"DetectionBot","nameLocation":"380:12:41","scope":49249,"usedErrors":[],"usedEvents":[]}],"license":"MIT"},"id":41}